(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define("BezierCanvas", [], factory);
	else if(typeof exports === 'object')
		exports["BezierCanvas"] = factory();
	else
		root["BezierCanvas"] = factory();
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 1);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * Point representation class
 */
var Point = /** @class */ (function () {
    function Point(x, y) {
        this.id = 0;
        this.active = false;
        this.parent = null;
        this.xCoord = x;
        this.yCoord = y;
        this.id = Point.count++;
    }
    Object.defineProperty(Point.prototype, "xCoord", {
        set: function (x) {
            this.x = Math.round(x);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Point.prototype, "yCoord", {
        set: function (y) {
            this.y = Math.round(y);
        },
        enumerable: true,
        configurable: true
    });
    Point.prototype.isActive = function () {
        return this.active;
    };
    Point.prototype.isHandler = function () {
        return this.isHandler1() || this.isHandler2();
    };
    Point.prototype.isHandler1 = function () {
        return this.parent.handler1 == this;
    };
    Point.prototype.isHandler2 = function () {
        return this.parent.handler2 == this;
    };
    Point.prototype.clone = function () {
        return new Point(this.x, this.y);
    };
    Point.prototype.toString = function () {
        return "(x: " + this.x + ", y: " + this.y + ")";
    };
    Point.count = 0;
    return Point;
}());
/* harmony default export */ __webpack_exports__["a"] = (Point);


/***/ }),
/* 1 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__polyfills__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__polyfills___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__polyfills__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Point__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__ConstructionPoint__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Shapes__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__LineCap__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__BezierUtils__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__HistoryManagerAbstract__ = __webpack_require__(7);
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();







var BezierCanvas = /** @class */ (function (_super) {
    __extends(BezierCanvas, _super);
    /*******************************************************/
    /**
     * Constructor
     * @param {HTMLCanvasElement} canvas
     * @param options Customization options
     */
    function BezierCanvas(canvas, options) {
        if (options === void 0) { options = {}; }
        var _this = _super.call(this) || this;
        _this.paintSplineOn = true;
        _this.constructionPoints = [];
        _this.mouseMoveThrottleTime = 30;
        _this.lastMouseMoveTime = NaN;
        _this.canvas = null;
        _this.ctx = null;
        _this.isMouseDown = false;
        _this.ctrlKeyIsDown = false;
        _this.currentMovingPoint = null;
        _this.mouseReleaseAfterConstructionPointCreation = true;
        _this.options = {
            historySize: 50,
            naturalDrawMode: true,
            maxDistance: 10,
            smoothFactor: 0.5,
            constraintTangents: true,
            constructionPointSize: 6,
            constructionPointBorderSize: 1,
            constructionPointBorderColor: 'rgb(150, 150, 150)',
            constructionPointFillColor: 'rgb(230, 230, 230)',
            constructionPointActiveFillColor: 'cyan',
            constructionPointActiveBorderColor: 'rgb(100, 120, 255)',
            constructionPointShape: __WEBPACK_IMPORTED_MODULE_3__Shapes__["a" /* Shapes */].Disc,
            controlPointBorderColor: 'rgb(120, 120, 120)',
            controlPointFillColor: 'rgb(180, 180, 180)',
            controlPointActiveFillColor: 'cyan',
            controlPointActiveBorderColor: 'rgb(100, 120, 255)',
            controlPointBorderSize: 10,
            controlPointSize: 4,
            controlPointShape: __WEBPACK_IMPORTED_MODULE_3__Shapes__["a" /* Shapes */].Disc,
            tangentColor: 'rgb(150, 150, 150)',
            tangentThickness: 2,
            lineCap: __WEBPACK_IMPORTED_MODULE_4__LineCap__["a" /* default */].Round,
            splineColor: 'rgb(0,0,200)',
            splineThickness: 5,
            showMaxNextAndPreviousTangents: 1 // Set -1 for all
        };
        /**
         * Get a position object from a mouse event
         * @param e
         * @returns {Point}
         */
        _this.getPosition = function (e) {
            var rect = _this.canvas.getBoundingClientRect();
            return new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](e.clientX - rect.left, e.clientY - rect.top);
        };
        _this.setOptions(options);
        _this.historySize = _this.options.historySize;
        if (options.hasOwnProperty('points')) {
            _this.setPoints(options.points);
        }
        _this.init(canvas);
        return _this;
    }
    /**
     * Get distance between 2 points
     * @param {Point} a First point
     * @param {Point} b Second point
     * @returns {number} Distance
     */
    BezierCanvas.getDistance = function (a, b) {
        return Math.sqrt(Math.pow(a.x - b.x, 2) + Math.pow(a.y - b.y, 2));
    };
    /**
     * Reset the current active point
     */
    BezierCanvas.prototype.resetActivePoint = function () {
        this.constructionPoints.forEach(function (point) {
            point.active = false;
            point.handler1.active = false;
            if (point.handler2) {
                point.handler2.active = false;
            }
        });
    };
    /**
     * Set a point to active
     * @param {Point} point
     */
    BezierCanvas.prototype.setActivePoint = function (point) {
        this.resetActivePoint();
        point.active = true;
        this.currentMovingPoint = point;
    };
    /**
     * Implementation of the De Casteljau's reverse algorithm to remove a construction point between 2 others
     * @param {ConstructionPoint} point
     */
    BezierCanvas.prototype.removeConstructionPoint = function (point) {
        var _this = this;
        var foundIndex = NaN, foundPoint = null, P0 = null, P1 = null, P2 = null, P3 = null;
        if (this.currentMovingPoint === point) {
            this.currentMovingPoint = null;
        }
        this.constructionPoints.forEach(function (curPoint, index) {
            if (curPoint.id === point.id) {
                foundIndex = index;
                foundPoint = curPoint;
                P0 = _this.constructionPoints[index - 1] || null;
                P1 = (P0 ? (P0.handler2 || P0.handler1) : null);
                P3 = _this.constructionPoints[index + 1] || null;
                P2 = (P3 ? P3.handler1 : null);
                return;
            }
        });
        if (point.fromCasteljau && P0 && P1 && P2 && P3) {
            var k = BezierCanvas.getDistance(foundPoint.handler2, foundPoint)
                / BezierCanvas.getDistance(foundPoint.handler1, foundPoint);
            if (!isNaN(k)) {
                var Px = (1 + k) * P1.x - k * P0.x;
                var Py = (1 + k) * P1.y - k * P0.y;
                var P = new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](Px, Py);
                var Qx = ((1 + k) * P2.x - P3.x) / k;
                var Qy = ((1 + k) * P2.y - P3.y) / k;
                var Q = new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](Qx, Qy);
                P1.x = P.x;
                P1.y = P.y;
                P2.x = Q.x;
                P2.y = Q.y;
            }
        }
        this.constructionPoints.splice(foundIndex, 1);
        if (this.constructionPoints.length && !this.options.naturalDrawMode) {
            // First & last points only have one handler (in normal mode)
            if (this.constructionPoints[0].handler2) {
                this.constructionPoints[0].handler1 = this.constructionPoints[0].handler2.clone();
                this.constructionPoints[0].handler2 = null;
            }
            this.constructionPoints[this.constructionPoints.length - 1].handler2 = null;
        }
    };
    /**
     * Get the closest construction point from position (x, y) or null if no one is closer or equal to maxDistance
     * @param {number} x X coordinate
     * @param {number} y Y coordinate
     * @returns {ConstructionPoint} Closest construction point
     */
    BezierCanvas.prototype.findClosestConstructionPoint = function (x, y) {
        var _this = this;
        var foundPoint = null;
        var position = new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](x, y);
        this.constructionPoints.forEach(function (curPoint) {
            var distance = BezierCanvas.getDistance(position, curPoint);
            if (distance < _this.options.maxDistance) {
                foundPoint = curPoint;
                return;
            }
        });
        return foundPoint;
    };
    /**
     * Projects a position (x,y) to a point on the current drawn Spline
     * @param {number} x X coordinate
     * @param {number} y Y coordinate
     * @returns {any} The projection point if it's found regarding maxDistance option, null else
     */
    BezierCanvas.prototype.findPointOnSpline = function (x, y) {
        var _this = this;
        var foundPoint = null, distance = NaN, position = NaN, t = NaN, P0 = null, P1 = null, P2 = null, P3 = null;
        var clickPosition = new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](x, y);
        var steps = 100; // Precision steps
        this.constructionPoints.forEach(function (currentPoint, index) {
            var nextPoint = _this.constructionPoints[index + 1];
            if (null == nextPoint) {
                return;
            }
            else {
                for (var i = 0; i <= steps; i++) {
                    var curPoint = __WEBPACK_IMPORTED_MODULE_5__BezierUtils__["a" /* default */].cubicBezierInterpolate(i / steps, currentPoint, currentPoint.handler2 || currentPoint.handler1, nextPoint.handler1, nextPoint);
                    var curDistance = BezierCanvas.getDistance(curPoint, clickPosition);
                    if (curDistance <= _this.options.maxDistance && (isNaN(distance) || distance > curDistance)) {
                        foundPoint = new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](curPoint.x, curPoint.y);
                        distance = curDistance;
                        position = index;
                        t = i / steps;
                        P0 = currentPoint;
                        P1 = (currentPoint.handler2 || currentPoint.handler1);
                        P2 = nextPoint.handler1;
                        P3 = nextPoint;
                    }
                }
            }
        });
        return foundPoint ? {
            point: foundPoint, distance: distance,
            position: position + 1, t: t, P0: P0, P1: P1, P2: P2, P3: P3
        } : null;
    };
    /**
     * Implementation of the De Casteljau's algorithm to insert a new construction point between 2 existing ones
     * @param t
     * @param P0
     * @param P1
     * @param P2
     * @param P3
     */
    BezierCanvas.prototype.knotInsertion = function (t, P0, P1, P2, P3) {
        var _this = this;
        var P4 = BezierCanvas.weighted(P0, P1, t);
        var P5 = BezierCanvas.weighted(P1, P2, t);
        var P6 = BezierCanvas.weighted(P2, P3, t);
        var P7 = BezierCanvas.weighted(P4, P5, t);
        var P8 = BezierCanvas.weighted(P5, P6, t);
        var P9 = BezierCanvas.weighted(P7, P8, t);
        var newPoint = new __WEBPACK_IMPORTED_MODULE_2__ConstructionPoint__["a" /* default */](P9.x, P9.y);
        newPoint.fromCasteljau = true;
        this.setActivePoint(newPoint);
        newPoint.handler1 = P7;
        newPoint.handler2 = P8;
        P1.x = P4.x;
        P1.y = P4.y;
        P2.x = P6.x;
        P2.y = P6.y;
        this.constructionPoints.forEach(function (point, index) {
            if (point.id === P0.id) {
                _this.constructionPoints.splice(index + 1, 0, newPoint);
                return;
            }
        });
    };
    /**
     * Mouse up management
     */
    BezierCanvas.prototype.bindCanvasMouseUp = function () {
        var _this = this;
        this.canvas.addEventListener('mouseup', function () {
            _this.isMouseDown = false;
            _this.mouseReleaseAfterConstructionPointCreation = true;
            _this.pushHistoryStateIfChanged();
        });
    };
    /**
     * Right click management
     */
    BezierCanvas.prototype.bindCanvasMouseDownRight = function () {
        var _this = this;
        this.canvas.addEventListener('contextmenu', function (e) {
            e.preventDefault();
            e.stopPropagation();
            var position = _this.getPosition(e);
            var point = _this.findClosestConstructionPoint(position.x, position.y);
            if (null != point) {
                _this.removeConstructionPoint(point);
            }
            return false;
        });
    };
    /**
     * Mouse Leave management
     */
    BezierCanvas.prototype.bindCanvasMouseLeave = function () {
        var _this = this;
        this.canvas.addEventListener('mouseleave', function (e) {
            e.preventDefault();
            e.stopPropagation();
            _this.isMouseDown = false;
            _this.mouseReleaseAfterConstructionPointCreation = true;
            _this.pushHistoryStateIfChanged();
            return false;
        });
    };
    /**
     * Left click management
     */
    BezierCanvas.prototype.bindCanvasMouseDownLeft = function () {
        var _this = this;
        this.canvas.addEventListener('mousedown', function (e) {
            if (e.which !== 1) {
                return;
            }
            _this.isMouseDown = true;
            var position = _this.getPosition(e);
            var distance = NaN, selectedPoint = null;
            if (_this.ctrlKeyIsDown) {
                _this.constructionPoints.forEach(function (constructionPoint) {
                    var pointsToCheck = [constructionPoint, constructionPoint.handler1];
                    if (constructionPoint.handler2) {
                        pointsToCheck.push(constructionPoint.handler2);
                    }
                    pointsToCheck.forEach(function (checkedPoint) {
                        var curDistance = BezierCanvas.getDistance(checkedPoint, position);
                        if (curDistance <= _this.options.maxDistance
                            && (isNaN(distance) || (distance >= curDistance))) {
                            distance = BezierCanvas.getDistance(checkedPoint, position);
                            selectedPoint = checkedPoint;
                        }
                    });
                });
                if (!selectedPoint) {
                    return (_this.currentMovingPoint = null);
                }
                else {
                    _this.setActivePoint(selectedPoint);
                }
            }
            else {
                var pointOnSpline = _this.findPointOnSpline(position.x, position.y);
                if (pointOnSpline) {
                    return _this.knotInsertion(pointOnSpline.t, pointOnSpline.P0, pointOnSpline.P1, pointOnSpline.P2, pointOnSpline.P3);
                }
            }
            if (!selectedPoint) {
                _this.mouseReleaseAfterConstructionPointCreation = false;
                var point = new __WEBPACK_IMPORTED_MODULE_2__ConstructionPoint__["a" /* default */](position.x, position.y);
                point.handler1 = new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](position.x, position.y); // We don't set the handler2, as it's the last point
                if (_this.options.naturalDrawMode) {
                    point.handler2 = new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](position.x, position.y);
                }
                _this.constructionPoints.push(point);
                _this.setActivePoint(_this.options.naturalDrawMode ? point.handler2 : point.handler1);
                if (_this.constructionPoints.length > 2) {
                    // Set the handler2 of the N-1 (previous) point (Level 1 smoothness (same derivative))
                    var D = _this.constructionPoints[_this.constructionPoints.length - 2]; // Prev construction point
                    if (_this.options.naturalDrawMode) {
                        D.handler1 = new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](D.x - _this.options.smoothFactor * (D.handler2.x - D.x), D.y - _this.options.smoothFactor * (D.handler2.y - D.y));
                    }
                    else {
                        D.handler2 = new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](D.x - _this.options.smoothFactor * (D.handler1.x - D.x), D.y - _this.options.smoothFactor * (D.handler1.y - D.y));
                    }
                }
            }
        });
    };
    /**
     * Key press management
     */
    BezierCanvas.prototype.bindKeyPress = function () {
        var _this = this;
        document.addEventListener('keydown', function (e) {
            var code = e.which || e.keyCode;
            if (e.ctrlKey) {
                _this.ctrlKeyIsDown = true;
            }
            _this.historyManagerHandleKeyboardEvents(e);
        });
        document.addEventListener('keyup', function () {
            _this.ctrlKeyIsDown = false;
        });
    };
    /**
     * Mouse move when mouse is pressed management
     */
    BezierCanvas.prototype.bindCanvasMouseDownMove = function () {
        var _this = this;
        this.canvas.addEventListener('mousemove', function (e) {
            if (!_this.isMouseDown) {
                return;
            }
            else {
                // Limit mouseMove events
                var time = new Date().getTime();
                if (!isNaN(_this.lastMouseMoveTime) && time < _this.lastMouseMoveTime + _this.mouseMoveThrottleTime) {
                    return;
                }
                else {
                    _this.lastMouseMoveTime = time;
                }
            }
            var position = _this.getPosition(e);
            var activePoint = _this.currentMovingPoint;
            if (!activePoint) {
                return false;
            }
            var delta1X = NaN, delta1Y = NaN;
            var delta2X = NaN, delta2Y = NaN;
            if (activePoint instanceof __WEBPACK_IMPORTED_MODULE_2__ConstructionPoint__["a" /* default */]) {
                delta1X = activePoint.x - activePoint.handler1.x;
                delta1Y = activePoint.y - activePoint.handler1.y;
                if (activePoint.handler2) {
                    delta2X = activePoint.x - activePoint.handler2.x;
                    delta2Y = activePoint.y - activePoint.handler2.y;
                }
            }
            if (!(activePoint instanceof __WEBPACK_IMPORTED_MODULE_2__ConstructionPoint__["a" /* default */])) {
                if (_this.options.constraintTangents) {
                    if (activePoint.isHandler1() && activePoint.parent.handler2) {
                        var distance1 = BezierCanvas.getDistance(position, activePoint.parent);
                        var distance2 = BezierCanvas.getDistance(activePoint.parent.handler2, activePoint.parent);
                        if (_this.options.naturalDrawMode && !_this.mouseReleaseAfterConstructionPointCreation) {
                            activePoint.parent.handler2.x = activePoint.parent.x - (position.x - activePoint.parent.x);
                            activePoint.parent.handler2.y = activePoint.parent.y - (position.y - activePoint.parent.y);
                        }
                        else {
                            var ratio = (distance1 / distance2);
                            if (ratio !== 0) {
                                activePoint.parent.handler2.x = activePoint.parent.x
                                    + (1 / ratio) * (activePoint.parent.x - position.x);
                                activePoint.parent.handler2.y = activePoint.parent.y
                                    + (1 / ratio) * (activePoint.parent.y - position.y);
                            }
                            else {
                                return;
                            }
                        }
                    }
                    else if (activePoint.isHandler2()) {
                        var distance1 = BezierCanvas.getDistance(position, activePoint.parent);
                        var distance2 = BezierCanvas.getDistance(activePoint.parent.handler1, activePoint.parent);
                        var ratio = (distance1 / distance2);
                        if (_this.options.naturalDrawMode && !_this.mouseReleaseAfterConstructionPointCreation) {
                            activePoint.parent.handler1.x = activePoint.parent.x - (position.x - activePoint.parent.x);
                            activePoint.parent.handler1.y = activePoint.parent.y - (position.y - activePoint.parent.y);
                        }
                        else {
                            if (ratio !== 0) {
                                activePoint.parent.handler1.x = activePoint.parent.x
                                    + (1 / ratio) * (activePoint.parent.x - position.x);
                                activePoint.parent.handler1.y = activePoint.parent.y
                                    + (1 / ratio) * (activePoint.parent.y - position.y);
                            }
                            else {
                                return;
                            }
                        }
                    }
                }
            }
            activePoint.x = position.x;
            activePoint.y = position.y;
            if (activePoint instanceof __WEBPACK_IMPORTED_MODULE_2__ConstructionPoint__["a" /* default */]) {
                activePoint.handler1.x = activePoint.x - delta1X;
                activePoint.handler1.y = activePoint.y - delta1Y;
                if (activePoint.handler2) {
                    activePoint.handler2.x = activePoint.x - delta2X;
                    activePoint.handler2.y = activePoint.y - delta2Y;
                }
            }
        });
    };
    /**
     * Renders a Construction Point
     * @param {ConstructionPoint} point
     */
    BezierCanvas.prototype.paintConstructionPoint = function (point) {
        this.ctx.save();
        this.ctx.strokeStyle = this.options.constructionPointBorderColor;
        this.ctx.fillStyle = this.options.constructionPointFillColor;
        this.ctx.lineWidth = this.options.constructionPointBorderSize;
        if (point.isActive()) {
            this.ctx.fillStyle = this.options.constructionPointActiveFillColor;
            this.ctx.strokeStyle = this.options.constructionPointActiveBorderColor;
        }
        switch (this.options.constructionPointShape) {
            case __WEBPACK_IMPORTED_MODULE_3__Shapes__["a" /* Shapes */].Disc:
                this.ctx.beginPath();
                this.ctx.arc(point.x, point.y, 0.5 * this.options.constructionPointSize, 0, 2 * Math.PI, false);
                if (this.options.constructionPointBorderSize > 0) {
                    this.ctx.lineWidth = this.options.constructionPointBorderSize;
                    this.ctx.stroke();
                }
                this.ctx.closePath();
                this.ctx.fill();
                break;
            case __WEBPACK_IMPORTED_MODULE_3__Shapes__["a" /* Shapes */].Square:
            default:
                this.ctx.fillRect(point.x - this.options.constructionPointSize / 2, point.y - this.options.constructionPointSize / 2, this.options.constructionPointSize, this.options.constructionPointSize);
                if (this.options.constructionPointBorderSize > 0) {
                    this.ctx.lineWidth = this.options.constructionPointBorderSize;
                    this.ctx.beginPath();
                    this.ctx.stroke();
                    this.ctx.closePath();
                }
                break;
        }
        this.ctx.restore();
    };
    /**
     * Renders a Control Point
     * @param {Point} point
     */
    BezierCanvas.prototype.paintControlPoint = function (point) {
        this.ctx.save();
        this.ctx.strokeStyle = this.options.controlPointBorderColor;
        this.ctx.fillStyle = this.options.controlPointFillColor;
        this.ctx.lineWidth = this.options.controlPointBorderSize;
        if (point.isActive()) {
            this.ctx.fillStyle = this.options.controlPointActiveFillColor;
            this.ctx.strokeStyle = this.options.controlPointActiveBorderColor;
        }
        switch (this.options.controlPointShape) {
            case __WEBPACK_IMPORTED_MODULE_3__Shapes__["a" /* Shapes */].Disc:
                this.ctx.beginPath();
                this.ctx.arc(point.x, point.y, 0.5 * this.options.controlPointSize, 0, 2 * Math.PI, false);
                this.ctx.fill();
                this.ctx.closePath();
                break;
            case __WEBPACK_IMPORTED_MODULE_3__Shapes__["a" /* Shapes */].Square:
                this.ctx.fillRect(point.x - this.options.controlPointSize / 2, point.y - this.options.controlPointSize / 2, this.options.controlPointSize, this.options.controlPointSize);
                break;
        }
        if (this.options.controlPointBorderSize > 0) {
            this.ctx.lineWidth = this.options.controlPointBorderSize;
            this.ctx.stroke();
        }
        this.ctx.restore();
    };
    /**
     * Renders tangent (segment between 2 Control points)
     * @param {Point} point1
     * @param {Point} point2
     */
    BezierCanvas.prototype.paintTangent = function (point1, point2) {
        if (!this.options.tangentThickness) {
            return;
        }
        this.ctx.save();
        this.ctx.strokeStyle = this.options.tangentColor;
        this.ctx.lineWidth = this.options.tangentThickness;
        this.ctx.beginPath();
        this.ctx.moveTo(point1.x, point1.y);
        this.ctx.lineTo(point2.x, point2.y);
        this.ctx.stroke();
        this.ctx.closePath();
        this.ctx.restore();
    };
    /**
     * Renders the Bezier spline
     */
    BezierCanvas.prototype.paintBezier = function () {
        var _this = this;
        if (this.constructionPoints.length > 1) {
            this.ctx.save();
            this.ctx.strokeStyle = this.options.splineColor;
            this.ctx.lineWidth = this.options.splineThickness;
            this.ctx.lineCap = __WEBPACK_IMPORTED_MODULE_4__LineCap__["a" /* default */].parse(this.options.lineCap);
            this.ctx.beginPath();
            this.constructionPoints.forEach(function (point, index) {
                if (_this.constructionPoints.length > 1 && index !== _this.constructionPoints.length - 1) {
                    var p0 = point, p3 = _this.constructionPoints[index + 1];
                    var p1 = (p0.handler2 || p0.handler1);
                    var p2 = p3.handler1;
                    _this.ctx.moveTo(p0.x, p0.y);
                    _this.ctx.bezierCurveTo(p1.x, p1.y, p2.x, p2.y, p3.x, p3.y);
                }
            });
            this.ctx.stroke();
            this.ctx.closePath();
            this.ctx.restore();
        }
    };
    /**
     * Renders the active point (separated method to make it on top of all other layers)
     * @param {Point} point
     */
    BezierCanvas.prototype.renderActivePoint = function (point) {
        if (point instanceof __WEBPACK_IMPORTED_MODULE_2__ConstructionPoint__["a" /* default */]) {
            this.paintConstructionPoint(point);
        }
        else {
            this.paintControlPoint(point);
        }
    };
    /**
     * Check if a point is linked to the active point (e.g. if it's one of its Control Points)
     * @param point
     * @returns {boolean}
     */
    BezierCanvas.prototype.concernsActivePoint = function (point) {
        if (!this.currentMovingPoint) {
            return false;
        }
        if (point instanceof __WEBPACK_IMPORTED_MODULE_2__ConstructionPoint__["a" /* default */]) {
            if (this.currentMovingPoint === (point.handler1)
                || (point.handler2 && this.currentMovingPoint === point.handler2)) {
                return true;
            }
        }
        else if (point === this.currentMovingPoint.parent) {
            return true;
        }
        return false;
    };
    /**
     * Check if there are less than maxPositionBefore points between active point and pointToCheck
     * @param {ConstructionPoint} pointToCheck
     * @param {number} maxPositionBefore
     * @returns {boolean}
     */
    BezierCanvas.prototype.isLessOrEqualThanPointsBefore = function (pointToCheck, maxPositionBefore) {
        var _this = this;
        if (!this.currentMovingPoint) {
            return false;
        }
        else {
            // Find active point & compared index
            var activeIndex_1 = NaN, comparedIndex_1 = NaN;
            this.constructionPoints.forEach(function (curPoint, i) {
                if ((_this.currentMovingPoint instanceof __WEBPACK_IMPORTED_MODULE_2__ConstructionPoint__["a" /* default */] && curPoint === _this.currentMovingPoint)
                    || ((!(_this.currentMovingPoint instanceof __WEBPACK_IMPORTED_MODULE_2__ConstructionPoint__["a" /* default */]))
                        && curPoint === _this.currentMovingPoint.parent)) {
                    activeIndex_1 = i;
                    if (!isNaN(comparedIndex_1)) {
                        return;
                    }
                }
                if (curPoint === pointToCheck) {
                    comparedIndex_1 = i;
                    if (!isNaN(activeIndex_1)) {
                        return;
                    }
                }
            });
            if (!isNaN(comparedIndex_1) && !isNaN(activeIndex_1)) {
                return Math.abs(comparedIndex_1 - activeIndex_1) <= maxPositionBefore;
            }
            return false;
        }
    };
    /**
     * Main rendering method that calls all sub rendering methods
     */
    BezierCanvas.prototype.paintSpline = function () {
        var _this = this;
        var activePoint = null;
        this.paintBezier();
        this.constructionPoints.forEach(function (point) {
            var paintControlPoints = false;
            if (_this.options.showMaxNextAndPreviousTangents === -1 || _this.concernsActivePoint(point)
                || _this.isLessOrEqualThanPointsBefore(point, _this.options.showMaxNextAndPreviousTangents)) {
                paintControlPoints = true;
                _this.paintTangent(point, point.handler1);
                if (point.handler2) {
                    _this.paintTangent(point, point.handler2);
                }
            }
            if (point.isActive()) {
                activePoint = point;
            }
            else {
                _this.paintConstructionPoint(point);
            }
            if (paintControlPoints) {
                if (point.handler1.isActive()) {
                    activePoint = point.handler1;
                }
                else {
                    _this.paintControlPoint(point.handler1);
                }
                if (point.handler2) {
                    if (point.handler2.isActive()) {
                        activePoint = point.handler2;
                    }
                    else {
                        _this.paintControlPoint(point.handler2);
                    }
                }
            }
            if (activePoint) {
                _this.renderActivePoint(activePoint);
            }
        });
    };
    /**
     * Initialize canvas and UI events management
     * @param canvas
     */
    BezierCanvas.prototype.init = function (canvas) {
        this.canvas = canvas;
        this.ctx = this.canvas.getContext('2d');
        this.canvas.width = this.canvas.offsetWidth;
        this.canvas.height = this.canvas.offsetHeight;
        this.bindCanvasMouseDownLeft();
        this.bindCanvasMouseUp();
        this.bindCanvasMouseDownMove();
        this.bindCanvasMouseDownRight();
        this.bindCanvasMouseLeave();
        this.bindKeyPress();
        this.paint();
    };
    /***** Implementation of History Manager Abstract ******/
    /**
     * Switch to historyState
     * @param historyState
     */
    BezierCanvas.prototype.applyHistoryState = function (historyState) {
        this.setPoints(historyState);
    };
    /**
     * Gets current state
     * @returns {Array<any>}
     */
    BezierCanvas.prototype.getCurrentState = function () {
        return this.getPoints();
    };
    /**
     * Gets an Hash of the current state
     * @returns {string}
     */
    BezierCanvas.prototype.getCurrentStateHash = function () {
        return JSON.stringify(this.getCurrentState());
    };
    /***********************************************PUBLIC API**********************************************/
    /**
     * Change current opttions
     * @param options JSON object
     */
    BezierCanvas.prototype.setOptions = function (options) {
        Object.assign(this.options, options);
    };
    /**
     * Triggers a view refreshment
     * @param {Function} callback
     */
    BezierCanvas.prototype.paint = function (callback) {
        if (callback === void 0) { callback = function () {
        }; }
        this.clear();
        if (this.paintSplineOn) {
            this.paintSpline();
        }
        callback(this.ctx);
    };
    /**
     * Starts a new blank project
     * @param {Function} callback
     */
    BezierCanvas.prototype.reset = function (callback) {
        if (callback === void 0) { callback = function () {
        }; }
        this.clear();
        this.historyReset();
        this.constructionPoints = [];
    };
    /**
     * Get current points - used for state management (import/export/history))
     * @returns {Array<any>}
     */
    BezierCanvas.prototype.getPoints = function () {
        var ret = [];
        this.constructionPoints.forEach(function (point) {
            var set = {
                x: point.x,
                y: point.y,
                hp1: { x: point.handler1.x, y: point.handler1.y }
            };
            if (point.handler2) {
                set['hp2'] = { x: point.handler2.x, y: point.handler2.y };
            }
            ret.push(set);
        });
        return ret;
    };
    /**
     * Set current points - used for state management
     * @returns {Array<any>}
     */
    BezierCanvas.prototype.setPoints = function (points) {
        var _this = this;
        this.reset();
        points.forEach(function (point) {
            var parsed = new __WEBPACK_IMPORTED_MODULE_2__ConstructionPoint__["a" /* default */](point.x, point.y);
            parsed.handler1 = new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](point.hp1.x, point.hp1.y);
            if (point.hasOwnProperty('hp2')) {
                parsed.handler2 = new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](point.hp2.x, point.hp2.y);
            }
            _this.constructionPoints.push(parsed);
        });
    };
    /**
     * Disable rendering
     */
    BezierCanvas.prototype.hideSpline = function () {
        this.paintSplineOn = false;
    };
    /**
     * Enable rendering
     */
    BezierCanvas.prototype.showSpline = function () {
        this.paintSplineOn = true;
    };
    /**
     * Clear canvas
     */
    BezierCanvas.prototype.clear = function () {
        if (this.ctx) {
            this.ctx.clearRect(-1, -1, 1 + this.canvas.width, 1 + this.canvas.height);
        }
    };
    /**
     * Given a number of shapes to draw; get all positions where to place shapes to be separated by an equal distance
     * @param {number} shapesCount  Number of shapes to draw along the spline
     * @returns {any}  Return an array with all positions on which drawing the shapes
     */
    BezierCanvas.prototype.getRegularlyPlacedPoints = function (shapesCount) {
        var _this = this;
        if (this.constructionPoints.length < 2) {
            return [];
        }
        var points = [], beziers = [];
        // Getting the total length
        var length = 0;
        this.constructionPoints.forEach(function (currentPoint, index) {
            var nextPoint = _this.constructionPoints[index + 1];
            if (null == nextPoint) {
                return;
            }
            else {
                var bz = new __WEBPACK_IMPORTED_MODULE_5__BezierUtils__["a" /* default */](currentPoint, currentPoint.handler2 || currentPoint.handler1, nextPoint.handler1, nextPoint);
                beziers.push(bz);
                length += bz.getLength();
            }
        });
        var drawnNumber = 0;
        var currentDistance = 0;
        beziers.forEach(function (bz, index) {
            currentDistance += bz.getLength();
            var shapesToStick = Math.floor((currentDistance / length) * shapesCount) - drawnNumber;
            if (index === bz.length - 1) {
                shapesToStick = shapesCount - drawnNumber;
            }
            drawnNumber += shapesToStick;
            if (shapesToStick > 0) {
                for (var t = 0; t < shapesToStick; t += 1) {
                    var x = NaN, y = NaN;
                    if (index === beziers.length - 1) {
                        x = bz.mx(t / (shapesToStick - 1));
                        y = bz.my(t / (shapesToStick - 1));
                    }
                    else {
                        x = bz.mx(t / (shapesToStick));
                        y = bz.my(t / (shapesToStick));
                    }
                    points.push(new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](x, y));
                }
            }
        });
        return points;
    };
    /**
     * Move along the segment defined by 2 points, depending on the weight
     * @param {Point} P0 First point
     * @param {Point} P1 Second point
     * @param {number} t Weight
     * @returns {Point}
     */
    BezierCanvas.weighted = function (P0, P1, t) {
        return new __WEBPACK_IMPORTED_MODULE_1__Point__["a" /* default */](P0.x * (1 - t) + P1.x * t, P0.y * (1 - t) + P1.y * t);
    };
    return BezierCanvas;
}(__WEBPACK_IMPORTED_MODULE_6__HistoryManagerAbstract__["a" /* default */]));
/* harmony default export */ __webpack_exports__["default"] = (BezierCanvas);


/***/ }),
/* 2 */
/***/ (function(module, exports) {

if (typeof Object.assign != 'function') {
    // Must be writable: true, enumerable: false, configurable: true
    Object.defineProperty(Object, "assign", {
        value: function assign(target, varArgs) {
            'use strict';
            if (target == null) {
                throw new TypeError('Cannot convert undefined or null to object');
            }
            var to = Object(target);
            for (var index = 1; index < arguments.length; index++) {
                var nextSource = arguments[index];
                if (nextSource != null) {
                    for (var nextKey in nextSource) {
                        // Avoid bugs when hasOwnProperty is shadowed
                        if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
                            to[nextKey] = nextSource[nextKey];
                        }
                    }
                }
            }
            return to;
        },
        writable: true,
        configurable: true
    });
}


/***/ }),
/* 3 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Point__ = __webpack_require__(0);
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();

/**
 * Bezier construction point representation
 */
var ConstructionPoint = /** @class */ (function (_super) {
    __extends(ConstructionPoint, _super);
    function ConstructionPoint() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._handler1 = null;
        _this._handler2 = null;
        _this.fromCasteljau = false;
        return _this;
    }
    Object.defineProperty(ConstructionPoint.prototype, "handler1", {
        /**
         * First control point getter
         * @returns {Point}
         */
        get: function () {
            return this._handler1;
        },
        /**
         * First control point setter
         * @returns {Point}
         */
        set: function (point) {
            this._handler1 = point;
            if (point) {
                this._handler1.parent = this;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ConstructionPoint.prototype, "handler2", {
        /**
         * Last control point getter
         * @returns {Point}
         */
        get: function () {
            return this._handler2;
        },
        /**
         * Last control point setter
         * @returns {Point}
         */
        set: function (point) {
            this._handler2 = point;
            if (point) {
                this._handler2.parent = this;
            }
        },
        enumerable: true,
        configurable: true
    });
    return ConstructionPoint;
}(__WEBPACK_IMPORTED_MODULE_0__Point__["a" /* default */]));
/* harmony default export */ __webpack_exports__["a"] = (ConstructionPoint);


/***/ }),
/* 4 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Shapes; });
/**
 * Available Shape types for construction points rendering
 * @type {{Square: string; Disc: string}}
 */
var Shapes = {
    Square: "square",
    Disc: "disc",
};


/***/ }),
/* 5 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * Available types of line caps for spline rendering
 */
var LineCap = /** @class */ (function () {
    function LineCap() {
    }
    LineCap.parse = function (val) {
        return (val === LineCap.Butt || val === LineCap.Round || val === LineCap.Square) ? val : LineCap.Round;
    };
    LineCap.Butt = "butt";
    LineCap.Round = "round";
    LineCap.Square = "square";
    return LineCap;
}());
/* harmony default export */ __webpack_exports__["a"] = (LineCap);
;


/***/ }),
/* 6 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Point__ = __webpack_require__(0);

/**
 * This class is used to place shapes along the whole spline to an equal distance
 *
 * (Note): Some parts of this file has been largely inspired by the following links :
 *
 * - https://gamedev.stackexchange.com/questions/5373/
 * /moving-ships-between-two-planets-along-a-bezier-missing-some-equations-for-acce/5427#5427
 * - http://www.carlosicaza.com/2012/08/12
 * /an-more-efficient-way-of-calculating-the-length-of-a-bezier-curve-part-ii/
 */
var BezierUtils = /** @class */ (function () {
    function BezierUtils(a, b, c, d, len) {
        if (len === void 0) { len = 200; }
        var _this = this;
        /**
         * Cubic bezier basic interpolation algorithm shortcut
         * @param {number} t
         * @returns {Point}
         */
        this.interpolate = function (t) {
            return BezierUtils.cubicBezierInterpolate(t, _this.a, _this.b, _this.c, _this.d);
        };
        this.a = a;
        this.b = b;
        this.c = c;
        this.d = d;
        this.len = len;
        this.arcLengths = new Array(this.len + 1);
        this.arcLengths[0] = 0;
        var interpolationPoint = this.interpolate(0);
        var ox = interpolationPoint.x, oy = interpolationPoint.y;
        var clen = 0;
        for (var i = 1; i <= this.len; i += 1) {
            var interpolation = this.interpolate(i / len);
            var x = interpolation.x;
            var y = interpolation.y;
            var dx = ox - x, dy = oy - y;
            clen += Math.sqrt(dx * dx + dy * dy);
            this.arcLengths[i] = clen;
            ox = x;
            oy = y;
        }
    }
    /**
     * Point re-mapper, try to remap a coordinate by ignoring spline dynamism,
     * ie: 0.5 should refer to the middle of the spline
     * @param {number} u bezier coordinate
     * @returns {number} mapped
     */
    BezierUtils.prototype.map = function (u) {
        var targetLength = u * this.arcLengths[this.len];
        var low = 0, high = this.len, index = 0;
        while (low < high) {
            index = low + (((high - low) / 2) | 0);
            if (this.arcLengths[index] < targetLength) {
                low = index + 1;
            }
            else {
                high = index;
            }
        }
        if (this.arcLengths[index] > targetLength) {
            index--;
        }
        var lengthBefore = this.arcLengths[index];
        if (lengthBefore === targetLength) {
            return index / this.len;
        }
        else {
            return (index + (targetLength - lengthBefore) / (this.arcLengths[index + 1] - lengthBefore)) / this.len;
        }
    };
    /**
     * Maps a bezier point to a cartesian one (x)
     * @param {number} u bezier point (0 to 1)
     * @returns {number} point.x
     */
    BezierUtils.prototype.mx = function (u) {
        return this.interpolate(this.map(u)).x;
    };
    /**
     * Maps a bezier point to a cartesian one (y)
     * @param {number} u bezier point (0 to 1)
     * @returns {number} point.y
     */
    BezierUtils.prototype.my = function (u) {
        return this.interpolate(this.map(u)).y;
    };
    /**
     * Gets the spline length
     * source: http://www.carlosicaza.com/2012/08/12
     * /an-more-efficient-way-of-calculating-the-length-of-a-bezier-curve-part-ii/
     */
    BezierUtils.prototype.getLength = function () {
        var steps = 100;
        var inc = 100;
        var length = 0;
        var t = 0;
        var pt = { x: NaN, y: NaN };
        var prevPt = { x: NaN, y: NaN };
        var c = [this.a, this.b, this.c, this.d];
        for (var i = 0; i < inc; i += 1) {
            t = i / steps;
            var t1 = 1.0 - t;
            var t1_3 = t1 * t1 * t1;
            var t1_3a = (3 * t) * (t1 * t1);
            var t1_3b = (3 * (t * t)) * t1;
            var t1_3c = (t * t * t);
            pt.x = (c[0].x * t1_3) + (t1_3a * c[1].x) + (t1_3b * c[2].x) + (t1_3c * c[3].x);
            pt.y = (c[0].y * t1_3) + (t1_3a * c[1].y) + (t1_3b * c[2].y) + (t1_3c * c[3].y);
            if (i > 0) {
                var x = pt.x - prevPt.x;
                var y = pt.y - prevPt.y;
                length = length + Math.sqrt(x * x + y * y);
            }
            prevPt.x = pt.x;
            prevPt.y = pt.y;
        }
        return length;
    };
    /**
     * Cubic bezier basic interpolation algorithm for curve C (P0, P1, P2, P3) at position t
     * @param {number} t
     * @param {Point} P0
     * @param {Point} P1
     * @param {Point} P2
     * @param {Point} P3
     * @returns {Point}
     */
    BezierUtils.cubicBezierInterpolate = function (t, P0, P1, P2, P3) {
        var x = P0.x * Math.pow(1 - t, 3) + 3 * P1.x * t * Math.pow((1 - t), 2)
            + 3 * P2.x * t * t * (1 - t) + +P3.x * t * t * t;
        var y = P0.y * Math.pow(1 - t, 3) + 3 * P1.y * t * Math.pow((1 - t), 2)
            + 3 * P2.y * t * t * (1 - t) + +P3.y * t * t * t;
        return new __WEBPACK_IMPORTED_MODULE_0__Point__["a" /* default */](x, y);
    };
    return BezierUtils;
}());
/* harmony default export */ __webpack_exports__["a"] = (BezierUtils);


/***/ }),
/* 7 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Keys__ = __webpack_require__(8);

var HistoryManagerAbstract = /** @class */ (function () {
    function HistoryManagerAbstract(historySize) {
        if (historySize === void 0) { historySize = 50; }
        this.historySize = historySize;
        this.statesCursor = 0;
        this.statesStack = [];
        this.lastHistoryStateHash = null;
    }
    HistoryManagerAbstract.prototype.safeStatesCursor = function (cursor) {
        this.statesCursor = Math.max(0, Math.min(this.statesStack.length - 1, cursor));
        return this.statesCursor;
    };
    HistoryManagerAbstract.prototype.removeFirstState = function () {
        this.statesStack.shift();
    };
    HistoryManagerAbstract.prototype.statesBackward = function () {
        if (this.statesStack.length) {
            this.applyHistoryState(this.statesStack[this.safeStatesCursor(this.statesCursor - 1)]);
        }
    };
    HistoryManagerAbstract.prototype.statesForward = function () {
        if (this.statesStack.length) {
            this.applyHistoryState(this.statesStack[this.safeStatesCursor(this.statesCursor + 1)]);
        }
    };
    HistoryManagerAbstract.prototype.historyManagerHandleKeyboardEvents = function (e) {
        var code = e.which || e.keyCode;
        if (code === __WEBPACK_IMPORTED_MODULE_0__Keys__["a" /* Keys */].Z && e.ctrlKey) {
            this.statesBackward();
        }
        if (code === __WEBPACK_IMPORTED_MODULE_0__Keys__["a" /* Keys */].Y && e.ctrlKey) {
            this.statesForward();
        }
    };
    HistoryManagerAbstract.prototype.pushHistoryState = function (state) {
        if (state === void 0) { state = null; }
        this.statesStack = this.statesStack.slice(0, this.statesCursor + 1);
        if (this.statesStack.length === this.historySize) {
            this.removeFirstState();
        }
        this.statesStack.push(state || this.getCurrentState());
        this.statesCursor = this.statesStack.length - 1;
    };
    HistoryManagerAbstract.prototype.pushHistoryStateIfChanged = function () {
        if (this.getCurrentStateHash() !== this.lastHistoryStateHash) {
            this.lastHistoryStateHash = this.getCurrentStateHash();
            this.pushHistoryState(this.getCurrentState());
        }
    };
    HistoryManagerAbstract.prototype.historyReset = function () {
        this.statesCursor = 0;
        this.statesStack = [];
        this.lastHistoryStateHash = null;
    };
    return HistoryManagerAbstract;
}());
/* harmony default export */ __webpack_exports__["a"] = (HistoryManagerAbstract);


/***/ }),
/* 8 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Keys; });
/**
 * Keyboard key codes
 * @type {{CTRL: number; Y: number; Z: number}}
 */
var Keys = {
    CTRL: 17,
    Y: 89,
    Z: 90
};


/***/ })
/******/ ])["default"];
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCAxMTE3YzY3OGE4MzYwODZhOThkZCIsIndlYnBhY2s6Ly8vLi9zcmMvUG9pbnQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0JlemllckNhbnZhcy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvcG9seWZpbGxzLnRzIiwid2VicGFjazovLy8uL3NyYy9Db25zdHJ1Y3Rpb25Qb2ludC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvU2hhcGVzLnRzIiwid2VicGFjazovLy8uL3NyYy9MaW5lQ2FwLnRzIiwid2VicGFjazovLy8uL3NyYy9CZXppZXJVdGlscy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvSGlzdG9yeU1hbmFnZXJBYnN0cmFjdC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvS2V5cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsTztBQ1ZBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBMkIsMEJBQTBCLEVBQUU7QUFDdkQseUNBQWlDLGVBQWU7QUFDaEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOERBQXNELCtEQUErRDs7QUFFckg7QUFDQTs7QUFFQTtBQUNBOzs7Ozs7OztBQzNEQTs7R0FFRztBQUNIO0lBUUksZUFBWSxDQUFTLEVBQUUsQ0FBUztRQU56QixPQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ1As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Q0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDekQsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1lBQzlCLENBQUMsR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFDO1lBQ2QsSUFBTSxFQUFFLEdBQVcsR0FBRyxHQUFHLENBQUMsQ0FBQztZQUMzQixJQUFNLElBQUksR0FBVyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQztZQUNsQyxJQUFNLEtBQUssR0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztZQUMxQyxJQUFNLEtBQUssR0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQztZQUN6QyxJQUFNLEtBQUssR0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFFLENBQUM7WUFDbkMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEYsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENB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KGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoXCJCZXppZXJDYW52YXNcIiwgW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiQmV6aWVyQ2FudmFzXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIkJlemllckNhbnZhc1wiXSA9IGZhY3RvcnkoKTtcbn0pKHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIFxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCAxMTE3YzY3OGE4MzYwODZhOThkZCIsImltcG9ydCBDb25zdHJ1Y3Rpb25Qb2ludCBmcm9tICcuL0NvbnN0cnVjdGlvblBvaW50JztcclxuXHJcbi8qKlxyXG4gKiBQb2ludCByZXByZXNlbnRhdGlvbiBjbGFzc1xyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9pbnQge1xyXG4gICAgc3RhdGljIGNvdW50ID0gMDtcclxuICAgIHB1YmxpYyBpZCA9IDA7XHJcbiAgICBwdWJsaWMgYWN0aXZlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwdWJsaWMgcGFyZW50OiBDb25zdHJ1Y3Rpb25Qb2ludCA9IG51bGw7XHJcbiAgICBwdWJsaWMgeDtcclxuICAgIHB1YmxpYyB5O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHg6IG51bWJlciwgeTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy54Q29vcmQgPSB4O1xyXG4gICAgICAgIHRoaXMueUNvb3JkID0geTtcclxuICAgICAgICB0aGlzLmlkID0gUG9pbnQuY291bnQrKztcclxuICAgIH1cclxuXHJcbiAgICBzZXQgeENvb3JkKHgpIHtcclxuICAgICAgICB0aGlzLnggPSBNYXRoLnJvdW5kKHgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCB5Q29vcmQoeSkge1xyXG4gICAgICAgIHRoaXMueSA9IE1hdGgucm91bmQoeSk7XHJcbiAgICB9XHJcblxyXG4gICAgaXNBY3RpdmUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYWN0aXZlO1xyXG4gICAgfVxyXG5cclxuICAgIGlzSGFuZGxlcigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pc0hhbmRsZXIxKCkgfHwgdGhpcy5pc0hhbmRsZXIyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgaXNIYW5kbGVyMSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuaGFuZGxlcjEgPT0gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBpc0hhbmRsZXIyKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5oYW5kbGVyMiA9PSB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb25lKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUG9pbnQodGhpcy54LCB0aGlzLnkpO1xyXG4gICAgfVxyXG5cclxuICAgIHRvU3RyaW5nKCl7XHJcbiAgICAgICAgcmV0dXJuIGAoeDogJHt0aGlzLnh9LCB5OiAke3RoaXMueX0pYDtcclxuICAgIH1cclxufVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL25vZGVfbW9kdWxlcy90c2xpbnQtbG9hZGVyPz9yZWYtLTEhLi9zcmMvUG9pbnQudHMiLCJpbXBvcnQgJy4vcG9seWZpbGxzJztcclxuaW1wb3J0IFBvaW50IGZyb20gJy4vUG9pbnQnO1xyXG5pbXBvcnQgQ29uc3RydWN0aW9uUG9pbnQgZnJvbSAnLi9Db25zdHJ1Y3Rpb25Qb2ludCc7XHJcbmltcG9ydCB7U2hhcGVzfSBmcm9tICcuL1NoYXBlcyc7XHJcbmltcG9ydCBMaW5lQ2FwIGZyb20gJy4vTGluZUNhcCc7XHJcbmltcG9ydCBCZXppZXJVdGlscyBmcm9tICcuL0JlemllclV0aWxzJztcclxuaW1wb3J0IEhpc3RvcnlNYW5hZ2VyQWJzdHJhY3QgZnJvbSAnLi9IaXN0b3J5TWFuYWdlckFic3RyYWN0JztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJlemllckNhbnZhcyBleHRlbmRzIEhpc3RvcnlNYW5hZ2VyQWJzdHJhY3Qge1xyXG5cclxuICAgIHByaXZhdGUgcGFpbnRTcGxpbmVPbiA9IHRydWU7XHJcbiAgICBwcml2YXRlIGNvbnN0cnVjdGlvblBvaW50cyA9IFtdO1xyXG4gICAgcHJpdmF0ZSBtb3VzZU1vdmVUaHJvdHRsZVRpbWUgPSAzMDtcclxuICAgIHByaXZhdGUgbGFzdE1vdXNlTW92ZVRpbWUgPSBOYU47XHJcbiAgICBwcml2YXRlIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBjdHg6IGFueSA9IG51bGw7XHJcbiAgICBwcml2YXRlIGlzTW91c2VEb3duID0gZmFsc2U7XHJcbiAgICBwcml2YXRlIGN0cmxLZXlJc0Rvd24gPSBmYWxzZTtcclxuICAgIHByaXZhdGUgY3VycmVudE1vdmluZ1BvaW50OiBQb2ludCA9IG51bGw7XHJcbiAgICBwcml2YXRlIG1vdXNlUmVsZWFzZUFmdGVyQ29uc3RydWN0aW9uUG9pbnRDcmVhdGlvbiA9IHRydWU7XHJcbiAgICBwcml2YXRlIG9wdGlvbnMgPSB7XHJcbiAgICAgICAgaGlzdG9yeVNpemU6IDUwLFxyXG4gICAgICAgIG5hdHVyYWxEcmF3TW9kZTogdHJ1ZSxcclxuICAgICAgICBtYXhEaXN0YW5jZTogMTAsXHJcbiAgICAgICAgc21vb3RoRmFjdG9yOiAwLjUsXHJcbiAgICAgICAgY29uc3RyYWludFRhbmdlbnRzOiB0cnVlLFxyXG5cclxuICAgICAgICBjb25zdHJ1Y3Rpb25Qb2ludFNpemU6IDYsXHJcbiAgICAgICAgY29uc3RydWN0aW9uUG9pbnRCb3JkZXJTaXplOiAxLFxyXG4gICAgICAgIGNvbnN0cnVjdGlvblBvaW50Qm9yZGVyQ29sb3I6ICdyZ2IoMTUwLCAxNTAsIDE1MCknLFxyXG4gICAgICAgIGNvbnN0cnVjdGlvblBvaW50RmlsbENvbG9yOiAncmdiKDIzMCwgMjMwLCAyMzApJyxcclxuICAgICAgICBjb25zdHJ1Y3Rpb25Qb2ludEFjdGl2ZUZpbGxDb2xvcjogJ2N5YW4nLFxyXG4gICAgICAgIGNvbnN0cnVjdGlvblBvaW50QWN0aXZlQm9yZGVyQ29sb3I6ICdyZ2IoMTAwLCAxMjAsIDI1NSknLFxyXG4gICAgICAgIGNvbnN0cnVjdGlvblBvaW50U2hhcGU6IFNoYXBlcy5EaXNjLFxyXG5cclxuICAgICAgICBjb250cm9sUG9pbnRCb3JkZXJDb2xvcjogJ3JnYigxMjAsIDEyMCwgMTIwKScsXHJcbiAgICAgICAgY29udHJvbFBvaW50RmlsbENvbG9yOiAncmdiKDE4MCwgMTgwLCAxODApJyxcclxuICAgICAgICBjb250cm9sUG9pbnRBY3RpdmVGaWxsQ29sb3I6ICdjeWFuJyxcclxuICAgICAgICBjb250cm9sUG9pbnRBY3RpdmVCb3JkZXJDb2xvcjogJ3JnYigxMDAsIDEyMCwgMjU1KScsXHJcbiAgICAgICAgY29udHJvbFBvaW50Qm9yZGVyU2l6ZTogMTAsXHJcbiAgICAgICAgY29udHJvbFBvaW50U2l6ZTogNCxcclxuICAgICAgICBjb250cm9sUG9pbnRTaGFwZTogU2hhcGVzLkRpc2MsXHJcblxyXG4gICAgICAgIHRhbmdlbnRDb2xvcjogJ3JnYigxNTAsIDE1MCwgMTUwKScsXHJcbiAgICAgICAgdGFuZ2VudFRoaWNrbmVzczogMixcclxuXHJcbiAgICAgICAgbGluZUNhcDogTGluZUNhcC5Sb3VuZCxcclxuICAgICAgICBzcGxpbmVDb2xvcjogJ3JnYigwLDAsMjAwKScsXHJcbiAgICAgICAgc3BsaW5lVGhpY2tuZXNzOiA1LFxyXG4gICAgICAgIHNob3dNYXhOZXh0QW5kUHJldmlvdXNUYW5nZW50czogMSAvLyBTZXQgLTEgZm9yIGFsbFxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCBkaXN0YW5jZSBiZXR3ZWVuIDIgcG9pbnRzXHJcbiAgICAgKiBAcGFyYW0ge1BvaW50fSBhIEZpcnN0IHBvaW50XHJcbiAgICAgKiBAcGFyYW0ge1BvaW50fSBiIFNlY29uZCBwb2ludFxyXG4gICAgICogQHJldHVybnMge251bWJlcn0gRGlzdGFuY2VcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgZ2V0RGlzdGFuY2UoYTogUG9pbnQsIGI6IFBvaW50KTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KE1hdGgucG93KGEueCAtIGIueCwgMikgKyBNYXRoLnBvdyhhLnkgLSBiLnksIDIpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE1vdmUgYWxvbmcgdGhlIHNlZ21lbnQgZGVmaW5lZCBieSAyIHBvaW50cywgZGVwZW5kaW5nIG9uIHRoZSB3ZWlnaHRcclxuICAgICAqIEBwYXJhbSB7UG9pbnR9IFAwIEZpcnN0IHBvaW50XHJcbiAgICAgKiBAcGFyYW0ge1BvaW50fSBQMSBTZWNvbmQgcG9pbnRcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0IFdlaWdodFxyXG4gICAgICogQHJldHVybnMge1BvaW50fVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHN0YXRpYyB3ZWlnaHRlZCA9IChQMDogUG9pbnQsIFAxOiBQb2ludCwgdDogbnVtYmVyKTogUG9pbnQgPT4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUG9pbnQoUDAueCAqICgxIC0gdCkgKyBQMS54ICogdCwgUDAueSAqICgxIC0gdCkgKyBQMS55ICogdCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNldCB0aGUgY3VycmVudCBhY3RpdmUgcG9pbnRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZXNldEFjdGl2ZVBvaW50KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY29uc3RydWN0aW9uUG9pbnRzLmZvckVhY2goKHBvaW50KSA9PiB7XHJcbiAgICAgICAgICAgIHBvaW50LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBwb2ludC5oYW5kbGVyMS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHBvaW50LmhhbmRsZXIyKSB7XHJcbiAgICAgICAgICAgICAgICBwb2ludC5oYW5kbGVyMi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2V0IGEgcG9pbnQgdG8gYWN0aXZlXHJcbiAgICAgKiBAcGFyYW0ge1BvaW50fSBwb2ludFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHNldEFjdGl2ZVBvaW50KHBvaW50OiBQb2ludCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMucmVzZXRBY3RpdmVQb2ludCgpO1xyXG4gICAgICAgIHBvaW50LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50TW92aW5nUG9pbnQgPSBwb2ludDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEltcGxlbWVudGF0aW9uIG9mIHRoZSBEZSBDYXN0ZWxqYXUncyByZXZlcnNlIGFsZ29yaXRobSB0byByZW1vdmUgYSBjb25zdHJ1Y3Rpb24gcG9pbnQgYmV0d2VlbiAyIG90aGVyc1xyXG4gICAgICogQHBhcmFtIHtDb25zdHJ1Y3Rpb25Qb2ludH0gcG9pbnRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZW1vdmVDb25zdHJ1Y3Rpb25Qb2ludChwb2ludDogQ29uc3RydWN0aW9uUG9pbnQpOiB2b2lkIHtcclxuICAgICAgICBsZXQgZm91bmRJbmRleCA9IE5hTiwgZm91bmRQb2ludCA9IG51bGwsIFAwID0gbnVsbCwgUDEgPSBudWxsLCBQMiA9IG51bGwsIFAzID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50TW92aW5nUG9pbnQgPT09IHBvaW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudE1vdmluZ1BvaW50ID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb25zdHJ1Y3Rpb25Qb2ludHMuZm9yRWFjaCgoY3VyUG9pbnQsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChjdXJQb2ludC5pZCA9PT0gcG9pbnQuaWQpIHtcclxuICAgICAgICAgICAgICAgIGZvdW5kSW5kZXggPSBpbmRleDtcclxuICAgICAgICAgICAgICAgIGZvdW5kUG9pbnQgPSBjdXJQb2ludDtcclxuICAgICAgICAgICAgICAgIFAwID0gdGhpcy5jb25zdHJ1Y3Rpb25Qb2ludHNbaW5kZXggLSAxXSB8fCBudWxsO1xyXG4gICAgICAgICAgICAgICAgUDEgPSAoUDAgPyAoUDAuaGFuZGxlcjIgfHwgUDAuaGFuZGxlcjEpIDogbnVsbCk7XHJcbiAgICAgICAgICAgICAgICBQMyA9IHRoaXMuY29uc3RydWN0aW9uUG9pbnRzW2luZGV4ICsgMV0gfHwgbnVsbDtcclxuICAgICAgICAgICAgICAgIFAyID0gKFAzID8gUDMuaGFuZGxlcjEgOiBudWxsKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChwb2ludC5mcm9tQ2FzdGVsamF1ICYmIFAwICYmIFAxICYmIFAyICYmIFAzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGsgPSBCZXppZXJDYW52YXMuZ2V0RGlzdGFuY2UoZm91bmRQb2ludC5oYW5kbGVyMiwgZm91bmRQb2ludClcclxuICAgICAgICAgICAgICAgIC8gQmV6aWVyQ2FudmFzLmdldERpc3RhbmNlKGZvdW5kUG9pbnQuaGFuZGxlcjEsIGZvdW5kUG9pbnQpO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGspKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBQeCA9ICgxICsgaykgKiBQMS54IC0gayAqIFAwLng7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBQeSA9ICgxICsgaykgKiBQMS55IC0gayAqIFAwLnk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBQID0gbmV3IFBvaW50KFB4LCBQeSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBReCA9ICgoMSArIGspICogUDIueCAtIFAzLngpIC8gaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IFF5ID0gKCgxICsgaykgKiBQMi55IC0gUDMueSkgLyBrO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgUSA9IG5ldyBQb2ludChReCwgUXkpO1xyXG4gICAgICAgICAgICAgICAgUDEueCA9IFAueDtcclxuICAgICAgICAgICAgICAgIFAxLnkgPSBQLnk7XHJcbiAgICAgICAgICAgICAgICBQMi54ID0gUS54O1xyXG4gICAgICAgICAgICAgICAgUDIueSA9IFEueTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jb25zdHJ1Y3Rpb25Qb2ludHMuc3BsaWNlKGZvdW5kSW5kZXgsIDEpO1xyXG4gICAgICAgIGlmICh0aGlzLmNvbnN0cnVjdGlvblBvaW50cy5sZW5ndGggJiYgIXRoaXMub3B0aW9ucy5uYXR1cmFsRHJhd01vZGUpIHtcclxuICAgICAgICAgICAgLy8gRmlyc3QgJiBsYXN0IHBvaW50cyBvbmx5IGhhdmUgb25lIGhhbmRsZXIgKGluIG5vcm1hbCBtb2RlKVxyXG4gICAgICAgICAgICBpZiAodGhpcy5jb25zdHJ1Y3Rpb25Qb2ludHNbMF0uaGFuZGxlcjIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29uc3RydWN0aW9uUG9pbnRzWzBdLmhhbmRsZXIxID0gdGhpcy5jb25zdHJ1Y3Rpb25Qb2ludHNbMF0uaGFuZGxlcjIuY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29uc3RydWN0aW9uUG9pbnRzWzBdLmhhbmRsZXIyID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmNvbnN0cnVjdGlvblBvaW50c1t0aGlzLmNvbnN0cnVjdGlvblBvaW50cy5sZW5ndGggLSAxXS5oYW5kbGVyMiA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBjbG9zZXN0IGNvbnN0cnVjdGlvbiBwb2ludCBmcm9tIHBvc2l0aW9uICh4LCB5KSBvciBudWxsIGlmIG5vIG9uZSBpcyBjbG9zZXIgb3IgZXF1YWwgdG8gbWF4RGlzdGFuY2VcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4IFggY29vcmRpbmF0ZVxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHkgWSBjb29yZGluYXRlXHJcbiAgICAgKiBAcmV0dXJucyB7Q29uc3RydWN0aW9uUG9pbnR9IENsb3Nlc3QgY29uc3RydWN0aW9uIHBvaW50XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZmluZENsb3Nlc3RDb25zdHJ1Y3Rpb25Qb2ludCh4OiBudW1iZXIsIHk6IG51bWJlcik6IENvbnN0cnVjdGlvblBvaW50IHwgbnVsbCB7XHJcbiAgICAgICAgbGV0IGZvdW5kUG9pbnQgPSBudWxsO1xyXG4gICAgICAgIGNvbnN0IHBvc2l0aW9uID0gbmV3IFBvaW50KHgsIHkpO1xyXG4gICAgICAgIHRoaXMuY29uc3RydWN0aW9uUG9pbnRzLmZvckVhY2goKGN1clBvaW50KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gQmV6aWVyQ2FudmFzLmdldERpc3RhbmNlKHBvc2l0aW9uLCBjdXJQb2ludCk7XHJcbiAgICAgICAgICAgIGlmIChkaXN0YW5jZSA8IHRoaXMub3B0aW9ucy5tYXhEaXN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgZm91bmRQb2ludCA9IGN1clBvaW50O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGZvdW5kUG9pbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcm9qZWN0cyBhIHBvc2l0aW9uICh4LHkpIHRvIGEgcG9pbnQgb24gdGhlIGN1cnJlbnQgZHJhd24gU3BsaW5lXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geCBYIGNvb3JkaW5hdGVcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5IFkgY29vcmRpbmF0ZVxyXG4gICAgICogQHJldHVybnMge2FueX0gVGhlIHByb2plY3Rpb24gcG9pbnQgaWYgaXQncyBmb3VuZCByZWdhcmRpbmcgbWF4RGlzdGFuY2Ugb3B0aW9uLCBudWxsIGVsc2VcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBmaW5kUG9pbnRPblNwbGluZSh4OiBudW1iZXIsIHk6IG51bWJlcik6IGFueSB7XHJcbiAgICAgICAgbGV0IGZvdW5kUG9pbnQgPSBudWxsLCBkaXN0YW5jZSA9IE5hTiwgcG9zaXRpb24gPSBOYU4sIHQgPSBOYU4sIFAwID0gbnVsbCwgUDEgPSBudWxsLCBQMiA9IG51bGwsIFAzID0gbnVsbDtcclxuICAgICAgICBjb25zdCBjbGlja1Bvc2l0aW9uID0gbmV3IFBvaW50KHgsIHkpO1xyXG4gICAgICAgIGNvbnN0IHN0ZXBzID0gMTAwOyAvLyBQcmVjaXNpb24gc3RlcHNcclxuICAgICAgICB0aGlzLmNvbnN0cnVjdGlvblBvaW50cy5mb3JFYWNoKChjdXJyZW50UG9pbnQsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5leHRQb2ludCA9IHRoaXMuY29uc3RydWN0aW9uUG9pbnRzW2luZGV4ICsgMV07XHJcbiAgICAgICAgICAgIGlmIChudWxsID09IG5leHRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gc3RlcHM7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1clBvaW50ID0gQmV6aWVyVXRpbHMuY3ViaWNCZXppZXJJbnRlcnBvbGF0ZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgaSAvIHN0ZXBzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UG9pbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQb2ludC5oYW5kbGVyMiB8fCBjdXJyZW50UG9pbnQuaGFuZGxlcjEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRQb2ludC5oYW5kbGVyMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFBvaW50XHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJEaXN0YW5jZSA9IEJlemllckNhbnZhcy5nZXREaXN0YW5jZShjdXJQb2ludCwgY2xpY2tQb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1ckRpc3RhbmNlIDw9IHRoaXMub3B0aW9ucy5tYXhEaXN0YW5jZSAmJiAoaXNOYU4oZGlzdGFuY2UpIHx8IGRpc3RhbmNlID4gY3VyRGlzdGFuY2UpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kUG9pbnQgPSBuZXcgUG9pbnQoY3VyUG9pbnQueCwgY3VyUG9pbnQueSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlID0gY3VyRGlzdGFuY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gaW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBpIC8gc3RlcHM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFAwID0gY3VycmVudFBvaW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBQMSA9IChjdXJyZW50UG9pbnQuaGFuZGxlcjIgfHwgY3VycmVudFBvaW50LmhhbmRsZXIxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUDIgPSBuZXh0UG9pbnQuaGFuZGxlcjE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFAzID0gbmV4dFBvaW50O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBmb3VuZFBvaW50ID8ge1xyXG4gICAgICAgICAgICBwb2ludDogZm91bmRQb2ludCwgZGlzdGFuY2U6IGRpc3RhbmNlLFxyXG4gICAgICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24gKyAxLCB0OiB0LCBQMDogUDAsIFAxOiBQMSwgUDI6IFAyLCBQMzogUDNcclxuICAgICAgICB9IDogbnVsbDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgRGUgQ2FzdGVsamF1J3MgYWxnb3JpdGhtIHRvIGluc2VydCBhIG5ldyBjb25zdHJ1Y3Rpb24gcG9pbnQgYmV0d2VlbiAyIGV4aXN0aW5nIG9uZXNcclxuICAgICAqIEBwYXJhbSB0XHJcbiAgICAgKiBAcGFyYW0gUDBcclxuICAgICAqIEBwYXJhbSBQMVxyXG4gICAgICogQHBhcmFtIFAyXHJcbiAgICAgKiBAcGFyYW0gUDNcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBrbm90SW5zZXJ0aW9uKHQsIFAwLCBQMSwgUDIsIFAzKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgUDQgPSBCZXppZXJDYW52YXMud2VpZ2h0ZWQoUDAsIFAxLCB0KTtcclxuICAgICAgICBjb25zdCBQNSA9IEJlemllckNhbnZhcy53ZWlnaHRlZChQMSwgUDIsIHQpO1xyXG4gICAgICAgIGNvbnN0IFA2ID0gQmV6aWVyQ2FudmFzLndlaWdodGVkKFAyLCBQMywgdCk7XHJcbiAgICAgICAgY29uc3QgUDcgPSBCZXppZXJDYW52YXMud2VpZ2h0ZWQoUDQsIFA1LCB0KTtcclxuICAgICAgICBjb25zdCBQOCA9IEJlemllckNhbnZhcy53ZWlnaHRlZChQNSwgUDYsIHQpO1xyXG4gICAgICAgIGNvbnN0IFA5ID0gQmV6aWVyQ2FudmFzLndlaWdodGVkKFA3LCBQOCwgdCk7XHJcbiAgICAgICAgY29uc3QgbmV3UG9pbnQgPSBuZXcgQ29uc3RydWN0aW9uUG9pbnQoUDkueCwgUDkueSk7XHJcbiAgICAgICAgbmV3UG9pbnQuZnJvbUNhc3RlbGphdSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zZXRBY3RpdmVQb2ludChuZXdQb2ludCk7XHJcbiAgICAgICAgbmV3UG9pbnQuaGFuZGxlcjEgPSBQNztcclxuICAgICAgICBuZXdQb2ludC5oYW5kbGVyMiA9IFA4O1xyXG4gICAgICAgIFAxLnggPSBQNC54O1xyXG4gICAgICAgIFAxLnkgPSBQNC55O1xyXG4gICAgICAgIFAyLnggPSBQNi54O1xyXG4gICAgICAgIFAyLnkgPSBQNi55O1xyXG4gICAgICAgIHRoaXMuY29uc3RydWN0aW9uUG9pbnRzLmZvckVhY2goKHBvaW50LCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAocG9pbnQuaWQgPT09IFAwLmlkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnN0cnVjdGlvblBvaW50cy5zcGxpY2UoaW5kZXggKyAxLCAwLCBuZXdQb2ludCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE1vdXNlIHVwIG1hbmFnZW1lbnRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBiaW5kQ2FudmFzTW91c2VVcCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmlzTW91c2VEb3duID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VSZWxlYXNlQWZ0ZXJDb25zdHJ1Y3Rpb25Qb2ludENyZWF0aW9uID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5wdXNoSGlzdG9yeVN0YXRlSWZDaGFuZ2VkKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSaWdodCBjbGljayBtYW5hZ2VtZW50XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYmluZENhbnZhc01vdXNlRG93blJpZ2h0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRleHRtZW51JywgKGU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5nZXRQb3NpdGlvbihlKTtcclxuICAgICAgICAgICAgY29uc3QgcG9pbnQgPSB0aGlzLmZpbmRDbG9zZXN0Q29uc3RydWN0aW9uUG9pbnQocG9zaXRpb24ueCwgcG9zaXRpb24ueSk7XHJcbiAgICAgICAgICAgIGlmIChudWxsICE9IHBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUNvbnN0cnVjdGlvblBvaW50KHBvaW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNb3VzZSBMZWF2ZSBtYW5hZ2VtZW50XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYmluZENhbnZhc01vdXNlTGVhdmUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIChlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLmlzTW91c2VEb3duID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VSZWxlYXNlQWZ0ZXJDb25zdHJ1Y3Rpb25Qb2ludENyZWF0aW9uID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5wdXNoSGlzdG9yeVN0YXRlSWZDaGFuZ2VkKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIExlZnQgY2xpY2sgbWFuYWdlbWVudFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGJpbmRDYW52YXNNb3VzZURvd25MZWZ0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlLndoaWNoICE9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5pc01vdXNlRG93biA9IHRydWU7XHJcbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5nZXRQb3NpdGlvbihlKTtcclxuICAgICAgICAgICAgbGV0IGRpc3RhbmNlID0gTmFOLCBzZWxlY3RlZFBvaW50ID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3RybEtleUlzRG93bikgeyAvLyBXaGVuIEN0cmwgS2V5IGlzIGRvd24sIGNoZWNrIGlmIG1vdXNlZG93biBvbiBhIHBvaW50XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnN0cnVjdGlvblBvaW50cy5mb3JFYWNoKChjb25zdHJ1Y3Rpb25Qb2ludCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvaW50c1RvQ2hlY2sgPSBbY29uc3RydWN0aW9uUG9pbnQsIGNvbnN0cnVjdGlvblBvaW50LmhhbmRsZXIxXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29uc3RydWN0aW9uUG9pbnQuaGFuZGxlcjIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzVG9DaGVjay5wdXNoKGNvbnN0cnVjdGlvblBvaW50LmhhbmRsZXIyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzVG9DaGVjay5mb3JFYWNoKChjaGVja2VkUG9pbnQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VyRGlzdGFuY2UgPSBCZXppZXJDYW52YXMuZ2V0RGlzdGFuY2UoY2hlY2tlZFBvaW50LCBwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJEaXN0YW5jZSA8PSB0aGlzLm9wdGlvbnMubWF4RGlzdGFuY2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIChpc05hTihkaXN0YW5jZSkgfHwgKGRpc3RhbmNlID49IGN1ckRpc3RhbmNlKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlID0gQmV6aWVyQ2FudmFzLmdldERpc3RhbmNlKGNoZWNrZWRQb2ludCwgcG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRQb2ludCA9IGNoZWNrZWRQb2ludDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGVjdGVkUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHRoaXMuY3VycmVudE1vdmluZ1BvaW50ID0gbnVsbCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QWN0aXZlUG9pbnQoc2VsZWN0ZWRQb2ludCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7IC8vIENoZWNrIGlmIGNvbnN0cnVjdGlvbiBwb2ludCB0byBpbnNlcnQgaXMgb24gc3BsaW5lIChiZXR3ZWVuIDIgb3RoZXIgY29uc3RydWN0aW9uIHBvaW50cylcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBvaW50T25TcGxpbmUgPSB0aGlzLmZpbmRQb2ludE9uU3BsaW5lKHBvc2l0aW9uLngsIHBvc2l0aW9uLnkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBvaW50T25TcGxpbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5rbm90SW5zZXJ0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludE9uU3BsaW5lLnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50T25TcGxpbmUuUDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50T25TcGxpbmUuUDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50T25TcGxpbmUuUDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50T25TcGxpbmUuUDNcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIXNlbGVjdGVkUG9pbnQpIHsgLy8gTm8gc2VsZWN0ZWQgcG9pbnQsIHRoZW4gY3JlYXRlIGEgbmV3IGNvbnN0cnVjdGlvbiBwb2ludFxyXG4gICAgICAgICAgICAgICAgdGhpcy5tb3VzZVJlbGVhc2VBZnRlckNvbnN0cnVjdGlvblBvaW50Q3JlYXRpb24gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBvaW50ID0gbmV3IENvbnN0cnVjdGlvblBvaW50KHBvc2l0aW9uLngsIHBvc2l0aW9uLnkpO1xyXG4gICAgICAgICAgICAgICAgcG9pbnQuaGFuZGxlcjEgPSBuZXcgUG9pbnQocG9zaXRpb24ueCwgcG9zaXRpb24ueSk7IC8vIFdlIGRvbid0IHNldCB0aGUgaGFuZGxlcjIsIGFzIGl0J3MgdGhlIGxhc3QgcG9pbnRcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMubmF0dXJhbERyYXdNb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnQuaGFuZGxlcjIgPSBuZXcgUG9pbnQocG9zaXRpb24ueCwgcG9zaXRpb24ueSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5jb25zdHJ1Y3Rpb25Qb2ludHMucHVzaChwb2ludCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEFjdGl2ZVBvaW50KHRoaXMub3B0aW9ucy5uYXR1cmFsRHJhd01vZGUgPyBwb2ludC5oYW5kbGVyMiA6IHBvaW50LmhhbmRsZXIxKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb25zdHJ1Y3Rpb25Qb2ludHMubGVuZ3RoID4gMikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgaGFuZGxlcjIgb2YgdGhlIE4tMSAocHJldmlvdXMpIHBvaW50IChMZXZlbCAxIHNtb290aG5lc3MgKHNhbWUgZGVyaXZhdGl2ZSkpXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgRCA9IHRoaXMuY29uc3RydWN0aW9uUG9pbnRzW3RoaXMuY29uc3RydWN0aW9uUG9pbnRzLmxlbmd0aCAtIDJdOyAvLyBQcmV2IGNvbnN0cnVjdGlvbiBwb2ludFxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMubmF0dXJhbERyYXdNb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEQuaGFuZGxlcjEgPSBuZXcgUG9pbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBELnggLSB0aGlzLm9wdGlvbnMuc21vb3RoRmFjdG9yICogKEQuaGFuZGxlcjIueCAtIEQueCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBELnkgLSB0aGlzLm9wdGlvbnMuc21vb3RoRmFjdG9yICogKEQuaGFuZGxlcjIueSAtIEQueSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgRC5oYW5kbGVyMiA9IG5ldyBQb2ludChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEQueCAtIHRoaXMub3B0aW9ucy5zbW9vdGhGYWN0b3IgKiAoRC5oYW5kbGVyMS54IC0gRC54KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEQueSAtIHRoaXMub3B0aW9ucy5zbW9vdGhGYWN0b3IgKiAoRC5oYW5kbGVyMS55IC0gRC55KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEtleSBwcmVzcyBtYW5hZ2VtZW50XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYmluZEtleVByZXNzKCk6IHZvaWQge1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvZGUgPSBlLndoaWNoIHx8IGUua2V5Q29kZTtcclxuICAgICAgICAgICAgaWYgKGUuY3RybEtleSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdHJsS2V5SXNEb3duID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmhpc3RvcnlNYW5hZ2VySGFuZGxlS2V5Ym9hcmRFdmVudHMoZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY3RybEtleUlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTW91c2UgbW92ZSB3aGVuIG1vdXNlIGlzIHByZXNzZWQgbWFuYWdlbWVudFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGJpbmRDYW52YXNNb3VzZURvd25Nb3ZlKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChlKSA9PiB7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNNb3VzZURvd24pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIExpbWl0IG1vdXNlTW92ZSBldmVudHNcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgICAgICAgICAgICAgIGlmICghaXNOYU4odGhpcy5sYXN0TW91c2VNb3ZlVGltZSkgJiYgdGltZSA8IHRoaXMubGFzdE1vdXNlTW92ZVRpbWUgKyB0aGlzLm1vdXNlTW92ZVRocm90dGxlVGltZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0TW91c2VNb3ZlVGltZSA9IHRpbWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5nZXRQb3NpdGlvbihlKTtcclxuICAgICAgICAgICAgY29uc3QgYWN0aXZlUG9pbnQgPSB0aGlzLmN1cnJlbnRNb3ZpbmdQb2ludDtcclxuXHJcbiAgICAgICAgICAgIGlmICghYWN0aXZlUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGV0IGRlbHRhMVggPSBOYU4sIGRlbHRhMVkgPSBOYU47XHJcbiAgICAgICAgICAgIGxldCBkZWx0YTJYID0gTmFOLCBkZWx0YTJZID0gTmFOO1xyXG5cclxuICAgICAgICAgICAgaWYgKGFjdGl2ZVBvaW50IGluc3RhbmNlb2YgQ29uc3RydWN0aW9uUG9pbnQpIHtcclxuICAgICAgICAgICAgICAgIGRlbHRhMVggPSBhY3RpdmVQb2ludC54IC0gYWN0aXZlUG9pbnQuaGFuZGxlcjEueDtcclxuICAgICAgICAgICAgICAgIGRlbHRhMVkgPSBhY3RpdmVQb2ludC55IC0gYWN0aXZlUG9pbnQuaGFuZGxlcjEueTtcclxuICAgICAgICAgICAgICAgIGlmIChhY3RpdmVQb2ludC5oYW5kbGVyMikge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbHRhMlggPSBhY3RpdmVQb2ludC54IC0gYWN0aXZlUG9pbnQuaGFuZGxlcjIueDtcclxuICAgICAgICAgICAgICAgICAgICBkZWx0YTJZID0gYWN0aXZlUG9pbnQueSAtIGFjdGl2ZVBvaW50LmhhbmRsZXIyLnk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghKGFjdGl2ZVBvaW50IGluc3RhbmNlb2YgQ29uc3RydWN0aW9uUG9pbnQpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmNvbnN0cmFpbnRUYW5nZW50cykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3RpdmVQb2ludC5pc0hhbmRsZXIxKCkgJiYgYWN0aXZlUG9pbnQucGFyZW50LmhhbmRsZXIyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpc3RhbmNlMSA9IEJlemllckNhbnZhcy5nZXREaXN0YW5jZShwb3NpdGlvbiwgYWN0aXZlUG9pbnQucGFyZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGlzdGFuY2UyID0gQmV6aWVyQ2FudmFzLmdldERpc3RhbmNlKGFjdGl2ZVBvaW50LnBhcmVudC5oYW5kbGVyMiwgYWN0aXZlUG9pbnQucGFyZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5uYXR1cmFsRHJhd01vZGUgJiYgIXRoaXMubW91c2VSZWxlYXNlQWZ0ZXJDb25zdHJ1Y3Rpb25Qb2ludENyZWF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVQb2ludC5wYXJlbnQuaGFuZGxlcjIueCA9IGFjdGl2ZVBvaW50LnBhcmVudC54IC0gKHBvc2l0aW9uLnggLSBhY3RpdmVQb2ludC5wYXJlbnQueCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVQb2ludC5wYXJlbnQuaGFuZGxlcjIueSA9IGFjdGl2ZVBvaW50LnBhcmVudC55IC0gKHBvc2l0aW9uLnkgLSBhY3RpdmVQb2ludC5wYXJlbnQueSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByYXRpbyA9IChkaXN0YW5jZTEgLyBkaXN0YW5jZTIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJhdGlvICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlUG9pbnQucGFyZW50LmhhbmRsZXIyLnggPSBhY3RpdmVQb2ludC5wYXJlbnQueFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICgxIC8gcmF0aW8pICogKGFjdGl2ZVBvaW50LnBhcmVudC54IC0gcG9zaXRpb24ueCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlUG9pbnQucGFyZW50LmhhbmRsZXIyLnkgPSBhY3RpdmVQb2ludC5wYXJlbnQueVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICgxIC8gcmF0aW8pICogKGFjdGl2ZVBvaW50LnBhcmVudC55IC0gcG9zaXRpb24ueSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aXZlUG9pbnQuaXNIYW5kbGVyMigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpc3RhbmNlMSA9IEJlemllckNhbnZhcy5nZXREaXN0YW5jZShwb3NpdGlvbiwgYWN0aXZlUG9pbnQucGFyZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGlzdGFuY2UyID0gQmV6aWVyQ2FudmFzLmdldERpc3RhbmNlKGFjdGl2ZVBvaW50LnBhcmVudC5oYW5kbGVyMSwgYWN0aXZlUG9pbnQucGFyZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmF0aW8gPSAoZGlzdGFuY2UxIC8gZGlzdGFuY2UyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5uYXR1cmFsRHJhd01vZGUgJiYgIXRoaXMubW91c2VSZWxlYXNlQWZ0ZXJDb25zdHJ1Y3Rpb25Qb2ludENyZWF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVQb2ludC5wYXJlbnQuaGFuZGxlcjEueCA9IGFjdGl2ZVBvaW50LnBhcmVudC54IC0gKHBvc2l0aW9uLnggLSBhY3RpdmVQb2ludC5wYXJlbnQueCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVQb2ludC5wYXJlbnQuaGFuZGxlcjEueSA9IGFjdGl2ZVBvaW50LnBhcmVudC55IC0gKHBvc2l0aW9uLnkgLSBhY3RpdmVQb2ludC5wYXJlbnQueSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmF0aW8gIT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVQb2ludC5wYXJlbnQuaGFuZGxlcjEueCA9IGFjdGl2ZVBvaW50LnBhcmVudC54XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgKDEgLyByYXRpbykgKiAoYWN0aXZlUG9pbnQucGFyZW50LnggLSBwb3NpdGlvbi54KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVQb2ludC5wYXJlbnQuaGFuZGxlcjEueSA9IGFjdGl2ZVBvaW50LnBhcmVudC55XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgKDEgLyByYXRpbykgKiAoYWN0aXZlUG9pbnQucGFyZW50LnkgLSBwb3NpdGlvbi55KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhY3RpdmVQb2ludC54ID0gcG9zaXRpb24ueDtcclxuICAgICAgICAgICAgYWN0aXZlUG9pbnQueSA9IHBvc2l0aW9uLnk7XHJcblxyXG4gICAgICAgICAgICBpZiAoYWN0aXZlUG9pbnQgaW5zdGFuY2VvZiBDb25zdHJ1Y3Rpb25Qb2ludCkge1xyXG4gICAgICAgICAgICAgICAgYWN0aXZlUG9pbnQuaGFuZGxlcjEueCA9IGFjdGl2ZVBvaW50LnggLSBkZWx0YTFYO1xyXG4gICAgICAgICAgICAgICAgYWN0aXZlUG9pbnQuaGFuZGxlcjEueSA9IGFjdGl2ZVBvaW50LnkgLSBkZWx0YTFZO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVBvaW50LmhhbmRsZXIyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlUG9pbnQuaGFuZGxlcjIueCA9IGFjdGl2ZVBvaW50LnggLSBkZWx0YTJYO1xyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZVBvaW50LmhhbmRsZXIyLnkgPSBhY3RpdmVQb2ludC55IC0gZGVsdGEyWTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IGEgcG9zaXRpb24gb2JqZWN0IGZyb20gYSBtb3VzZSBldmVudFxyXG4gICAgICogQHBhcmFtIGVcclxuICAgICAqIEByZXR1cm5zIHtQb2ludH1cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRQb3NpdGlvbiA9IChlOiBhbnkpOiBQb2ludCA9PiB7XHJcbiAgICAgICAgY29uc3QgcmVjdCA9IHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUG9pbnQoZS5jbGllbnRYIC0gcmVjdC5sZWZ0LCBlLmNsaWVudFkgLSByZWN0LnRvcCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXJzIGEgQ29uc3RydWN0aW9uIFBvaW50XHJcbiAgICAgKiBAcGFyYW0ge0NvbnN0cnVjdGlvblBvaW50fSBwb2ludFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHBhaW50Q29uc3RydWN0aW9uUG9pbnQocG9pbnQ6IENvbnN0cnVjdGlvblBvaW50KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jdHguc2F2ZSgpO1xyXG4gICAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5vcHRpb25zLmNvbnN0cnVjdGlvblBvaW50Qm9yZGVyQ29sb3I7XHJcbiAgICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gdGhpcy5vcHRpb25zLmNvbnN0cnVjdGlvblBvaW50RmlsbENvbG9yO1xyXG4gICAgICAgIHRoaXMuY3R4LmxpbmVXaWR0aCA9IHRoaXMub3B0aW9ucy5jb25zdHJ1Y3Rpb25Qb2ludEJvcmRlclNpemU7XHJcbiAgICAgICAgaWYgKHBvaW50LmlzQWN0aXZlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gdGhpcy5vcHRpb25zLmNvbnN0cnVjdGlvblBvaW50QWN0aXZlRmlsbENvbG9yO1xyXG4gICAgICAgICAgICB0aGlzLmN0eC5zdHJva2VTdHlsZSA9IHRoaXMub3B0aW9ucy5jb25zdHJ1Y3Rpb25Qb2ludEFjdGl2ZUJvcmRlckNvbG9yO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzd2l0Y2ggKHRoaXMub3B0aW9ucy5jb25zdHJ1Y3Rpb25Qb2ludFNoYXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgU2hhcGVzLkRpc2M6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmFyYyhwb2ludC54LCBwb2ludC55LCAwLjUgKiB0aGlzLm9wdGlvbnMuY29uc3RydWN0aW9uUG9pbnRTaXplLCAwLCAyICogTWF0aC5QSSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5jb25zdHJ1Y3Rpb25Qb2ludEJvcmRlclNpemUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdHgubGluZVdpZHRoID0gdGhpcy5vcHRpb25zLmNvbnN0cnVjdGlvblBvaW50Qm9yZGVyU2l6ZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN0eC5zdHJva2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdHguZmlsbCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgU2hhcGVzLlNxdWFyZTpcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmZpbGxSZWN0KFxyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50LnggLSB0aGlzLm9wdGlvbnMuY29uc3RydWN0aW9uUG9pbnRTaXplIC8gMixcclxuICAgICAgICAgICAgICAgICAgICBwb2ludC55IC0gdGhpcy5vcHRpb25zLmNvbnN0cnVjdGlvblBvaW50U2l6ZSAvIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmNvbnN0cnVjdGlvblBvaW50U2l6ZSxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuY29uc3RydWN0aW9uUG9pbnRTaXplKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuY29uc3RydWN0aW9uUG9pbnRCb3JkZXJTaXplID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3R4LmxpbmVXaWR0aCA9IHRoaXMub3B0aW9ucy5jb25zdHJ1Y3Rpb25Qb2ludEJvcmRlclNpemU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdHguc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdHguY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jdHgucmVzdG9yZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVuZGVycyBhIENvbnRyb2wgUG9pbnRcclxuICAgICAqIEBwYXJhbSB7UG9pbnR9IHBvaW50XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcGFpbnRDb250cm9sUG9pbnQocG9pbnQ6IFBvaW50KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jdHguc2F2ZSgpO1xyXG4gICAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5vcHRpb25zLmNvbnRyb2xQb2ludEJvcmRlckNvbG9yO1xyXG4gICAgICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9IHRoaXMub3B0aW9ucy5jb250cm9sUG9pbnRGaWxsQ29sb3I7XHJcbiAgICAgICAgdGhpcy5jdHgubGluZVdpZHRoID0gdGhpcy5vcHRpb25zLmNvbnRyb2xQb2ludEJvcmRlclNpemU7XHJcbiAgICAgICAgaWYgKHBvaW50LmlzQWN0aXZlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gdGhpcy5vcHRpb25zLmNvbnRyb2xQb2ludEFjdGl2ZUZpbGxDb2xvcjtcclxuICAgICAgICAgICAgdGhpcy5jdHguc3Ryb2tlU3R5bGUgPSB0aGlzLm9wdGlvbnMuY29udHJvbFBvaW50QWN0aXZlQm9yZGVyQ29sb3I7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN3aXRjaCAodGhpcy5vcHRpb25zLmNvbnRyb2xQb2ludFNoYXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgU2hhcGVzLkRpc2M6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmFyYyhwb2ludC54LCBwb2ludC55LCAwLjUgKiB0aGlzLm9wdGlvbnMuY29udHJvbFBvaW50U2l6ZSwgMCwgMiAqIE1hdGguUEksIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmZpbGwoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgU2hhcGVzLlNxdWFyZTpcclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmZpbGxSZWN0KFxyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50LnggLSB0aGlzLm9wdGlvbnMuY29udHJvbFBvaW50U2l6ZSAvIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnQueSAtIHRoaXMub3B0aW9ucy5jb250cm9sUG9pbnRTaXplIC8gMixcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuY29udHJvbFBvaW50U2l6ZSxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuY29udHJvbFBvaW50U2l6ZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmNvbnRyb2xQb2ludEJvcmRlclNpemUgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3R4LmxpbmVXaWR0aCA9IHRoaXMub3B0aW9ucy5jb250cm9sUG9pbnRCb3JkZXJTaXplO1xyXG4gICAgICAgICAgICB0aGlzLmN0eC5zdHJva2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jdHgucmVzdG9yZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVuZGVycyB0YW5nZW50IChzZWdtZW50IGJldHdlZW4gMiBDb250cm9sIHBvaW50cylcclxuICAgICAqIEBwYXJhbSB7UG9pbnR9IHBvaW50MVxyXG4gICAgICogQHBhcmFtIHtQb2ludH0gcG9pbnQyXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcGFpbnRUYW5nZW50KHBvaW50MTogUG9pbnQsIHBvaW50MjogUG9pbnQpOiB2b2lkIHtcclxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy50YW5nZW50VGhpY2tuZXNzKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jdHguc2F2ZSgpO1xyXG4gICAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5vcHRpb25zLnRhbmdlbnRDb2xvcjtcclxuICAgICAgICB0aGlzLmN0eC5saW5lV2lkdGggPSB0aGlzLm9wdGlvbnMudGFuZ2VudFRoaWNrbmVzcztcclxuICAgICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICB0aGlzLmN0eC5tb3ZlVG8ocG9pbnQxLngsIHBvaW50MS55KTtcclxuICAgICAgICB0aGlzLmN0eC5saW5lVG8ocG9pbnQyLngsIHBvaW50Mi55KTtcclxuICAgICAgICB0aGlzLmN0eC5zdHJva2UoKTtcclxuICAgICAgICB0aGlzLmN0eC5jbG9zZVBhdGgoKTtcclxuICAgICAgICB0aGlzLmN0eC5yZXN0b3JlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXJzIHRoZSBCZXppZXIgc3BsaW5lXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcGFpbnRCZXppZXIoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuY29uc3RydWN0aW9uUG9pbnRzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgdGhpcy5jdHguc2F2ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmN0eC5zdHJva2VTdHlsZSA9IHRoaXMub3B0aW9ucy5zcGxpbmVDb2xvcjtcclxuICAgICAgICAgICAgdGhpcy5jdHgubGluZVdpZHRoID0gdGhpcy5vcHRpb25zLnNwbGluZVRoaWNrbmVzcztcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY3R4LmxpbmVDYXAgPSBMaW5lQ2FwLnBhcnNlKHRoaXMub3B0aW9ucy5saW5lQ2FwKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnN0cnVjdGlvblBvaW50cy5mb3JFYWNoKChwb2ludCwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnN0cnVjdGlvblBvaW50cy5sZW5ndGggPiAxICYmIGluZGV4ICE9PSB0aGlzLmNvbnN0cnVjdGlvblBvaW50cy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcDAgPSBwb2ludCwgcDMgPSB0aGlzLmNvbnN0cnVjdGlvblBvaW50c1tpbmRleCArIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHAxID0gKHAwLmhhbmRsZXIyIHx8IHAwLmhhbmRsZXIxKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwMiA9IHAzLmhhbmRsZXIxO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3R4Lm1vdmVUbyhwMC54LCBwMC55KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN0eC5iZXppZXJDdXJ2ZVRvKHAxLngsIHAxLnksIHAyLngsIHAyLnksIHAzLngsIHAzLnkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5jdHguc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY3R4LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICB0aGlzLmN0eC5yZXN0b3JlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVuZGVycyB0aGUgYWN0aXZlIHBvaW50IChzZXBhcmF0ZWQgbWV0aG9kIHRvIG1ha2UgaXQgb24gdG9wIG9mIGFsbCBvdGhlciBsYXllcnMpXHJcbiAgICAgKiBAcGFyYW0ge1BvaW50fSBwb2ludFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlbmRlckFjdGl2ZVBvaW50KHBvaW50OiBQb2ludCk6IHZvaWQge1xyXG4gICAgICAgIGlmIChwb2ludCBpbnN0YW5jZW9mIENvbnN0cnVjdGlvblBvaW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnRDb25zdHJ1Y3Rpb25Qb2ludChwb2ludCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5wYWludENvbnRyb2xQb2ludChwb2ludCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2sgaWYgYSBwb2ludCBpcyBsaW5rZWQgdG8gdGhlIGFjdGl2ZSBwb2ludCAoZS5nLiBpZiBpdCdzIG9uZSBvZiBpdHMgQ29udHJvbCBQb2ludHMpXHJcbiAgICAgKiBAcGFyYW0gcG9pbnRcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNvbmNlcm5zQWN0aXZlUG9pbnQocG9pbnQpOiBib29sZWFuIHtcclxuICAgICAgICBpZiAoIXRoaXMuY3VycmVudE1vdmluZ1BvaW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHBvaW50IGluc3RhbmNlb2YgQ29uc3RydWN0aW9uUG9pbnQpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudE1vdmluZ1BvaW50ID09PSAocG9pbnQuaGFuZGxlcjEpXHJcbiAgICAgICAgICAgICAgICB8fCAocG9pbnQuaGFuZGxlcjIgJiYgdGhpcy5jdXJyZW50TW92aW5nUG9pbnQgPT09IHBvaW50LmhhbmRsZXIyKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKHBvaW50ID09PSB0aGlzLmN1cnJlbnRNb3ZpbmdQb2ludC5wYXJlbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIHRoZXJlIGFyZSBsZXNzIHRoYW4gbWF4UG9zaXRpb25CZWZvcmUgcG9pbnRzIGJldHdlZW4gYWN0aXZlIHBvaW50IGFuZCBwb2ludFRvQ2hlY2tcclxuICAgICAqIEBwYXJhbSB7Q29uc3RydWN0aW9uUG9pbnR9IHBvaW50VG9DaGVja1xyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG1heFBvc2l0aW9uQmVmb3JlXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBpc0xlc3NPckVxdWFsVGhhblBvaW50c0JlZm9yZShwb2ludFRvQ2hlY2s6IENvbnN0cnVjdGlvblBvaW50LCBtYXhQb3NpdGlvbkJlZm9yZTogbnVtYmVyKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRNb3ZpbmdQb2ludCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gRmluZCBhY3RpdmUgcG9pbnQgJiBjb21wYXJlZCBpbmRleFxyXG4gICAgICAgICAgICBsZXQgYWN0aXZlSW5kZXggPSBOYU4sIGNvbXBhcmVkSW5kZXggPSBOYU47XHJcbiAgICAgICAgICAgIHRoaXMuY29uc3RydWN0aW9uUG9pbnRzLmZvckVhY2goKGN1clBvaW50LCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHRoaXMuY3VycmVudE1vdmluZ1BvaW50IGluc3RhbmNlb2YgQ29uc3RydWN0aW9uUG9pbnQgJiYgY3VyUG9pbnQgPT09IHRoaXMuY3VycmVudE1vdmluZ1BvaW50KVxyXG4gICAgICAgICAgICAgICAgICAgIHx8ICgoISh0aGlzLmN1cnJlbnRNb3ZpbmdQb2ludCBpbnN0YW5jZW9mIENvbnN0cnVjdGlvblBvaW50KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgY3VyUG9pbnQgPT09IHRoaXMuY3VycmVudE1vdmluZ1BvaW50LnBhcmVudClcclxuICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKGNvbXBhcmVkSW5kZXgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY3VyUG9pbnQgPT09IHBvaW50VG9DaGVjaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBhcmVkSW5kZXggPSBpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4oYWN0aXZlSW5kZXgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGNvbXBhcmVkSW5kZXgpICYmICFpc05hTihhY3RpdmVJbmRleCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmFicyhjb21wYXJlZEluZGV4IC0gYWN0aXZlSW5kZXgpIDw9IG1heFBvc2l0aW9uQmVmb3JlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNYWluIHJlbmRlcmluZyBtZXRob2QgdGhhdCBjYWxscyBhbGwgc3ViIHJlbmRlcmluZyBtZXRob2RzXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcGFpbnRTcGxpbmUoKTogdm9pZCB7XHJcbiAgICAgICAgbGV0IGFjdGl2ZVBvaW50ID0gbnVsbDtcclxuXHJcbiAgICAgICAgdGhpcy5wYWludEJlemllcigpO1xyXG4gICAgICAgIHRoaXMuY29uc3RydWN0aW9uUG9pbnRzLmZvckVhY2goKHBvaW50KSA9PiB7XHJcblxyXG4gICAgICAgICAgICBsZXQgcGFpbnRDb250cm9sUG9pbnRzID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNob3dNYXhOZXh0QW5kUHJldmlvdXNUYW5nZW50cyA9PT0gLTEgfHwgdGhpcy5jb25jZXJuc0FjdGl2ZVBvaW50KHBvaW50KVxyXG4gICAgICAgICAgICAgICAgfHwgdGhpcy5pc0xlc3NPckVxdWFsVGhhblBvaW50c0JlZm9yZShwb2ludCwgdGhpcy5vcHRpb25zLnNob3dNYXhOZXh0QW5kUHJldmlvdXNUYW5nZW50cykpIHtcclxuICAgICAgICAgICAgICAgIHBhaW50Q29udHJvbFBvaW50cyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50VGFuZ2VudChwb2ludCwgcG9pbnQuaGFuZGxlcjEpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBvaW50LmhhbmRsZXIyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWludFRhbmdlbnQocG9pbnQsIHBvaW50LmhhbmRsZXIyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHBvaW50LmlzQWN0aXZlKCkpIHtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZVBvaW50ID0gcG9pbnQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhaW50Q29uc3RydWN0aW9uUG9pbnQocG9pbnQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAocGFpbnRDb250cm9sUG9pbnRzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocG9pbnQuaGFuZGxlcjEuaXNBY3RpdmUoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZVBvaW50ID0gcG9pbnQuaGFuZGxlcjE7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFpbnRDb250cm9sUG9pbnQocG9pbnQuaGFuZGxlcjEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChwb2ludC5oYW5kbGVyMikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2ludC5oYW5kbGVyMi5pc0FjdGl2ZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVBvaW50ID0gcG9pbnQuaGFuZGxlcjI7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWludENvbnRyb2xQb2ludChwb2ludC5oYW5kbGVyMik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYWN0aXZlUG9pbnQpIHsgLy8gUmVuZGVyIGF0IGxhc3QgdG8gbWFrZSBpdCBvdmVyIGFsbCBsYXllcnNcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyQWN0aXZlUG9pbnQoYWN0aXZlUG9pbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJbml0aWFsaXplIGNhbnZhcyBhbmQgVUkgZXZlbnRzIG1hbmFnZW1lbnRcclxuICAgICAqIEBwYXJhbSBjYW52YXNcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBpbml0KGNhbnZhcyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY2FudmFzID0gY2FudmFzO1xyXG4gICAgICAgIHRoaXMuY3R4ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMuY2FudmFzLm9mZnNldFdpZHRoO1xyXG4gICAgICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMuY2FudmFzLm9mZnNldEhlaWdodDtcclxuICAgICAgICB0aGlzLmJpbmRDYW52YXNNb3VzZURvd25MZWZ0KCk7XHJcbiAgICAgICAgdGhpcy5iaW5kQ2FudmFzTW91c2VVcCgpO1xyXG4gICAgICAgIHRoaXMuYmluZENhbnZhc01vdXNlRG93bk1vdmUoKTtcclxuICAgICAgICB0aGlzLmJpbmRDYW52YXNNb3VzZURvd25SaWdodCgpO1xyXG4gICAgICAgIHRoaXMuYmluZENhbnZhc01vdXNlTGVhdmUoKTtcclxuICAgICAgICB0aGlzLmJpbmRLZXlQcmVzcygpO1xyXG4gICAgICAgIHRoaXMucGFpbnQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKioqKiogSW1wbGVtZW50YXRpb24gb2YgSGlzdG9yeSBNYW5hZ2VyIEFic3RyYWN0ICoqKioqKi9cclxuICAgIC8qKlxyXG4gICAgICogU3dpdGNoIHRvIGhpc3RvcnlTdGF0ZVxyXG4gICAgICogQHBhcmFtIGhpc3RvcnlTdGF0ZVxyXG4gICAgICovXHJcbiAgICBwcm90ZWN0ZWQgYXBwbHlIaXN0b3J5U3RhdGUoaGlzdG9yeVN0YXRlOiBhbnkpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnNldFBvaW50cyhoaXN0b3J5U3RhdGUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0cyBjdXJyZW50IHN0YXRlXHJcbiAgICAgKiBAcmV0dXJucyB7QXJyYXk8YW55Pn1cclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIGdldEN1cnJlbnRTdGF0ZSgpOiBBcnJheTxhbnk+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRQb2ludHMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldHMgYW4gSGFzaCBvZiB0aGUgY3VycmVudCBzdGF0ZVxyXG4gICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIGdldEN1cnJlbnRTdGF0ZUhhc2goKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy5nZXRDdXJyZW50U3RhdGUoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RvclxyXG4gICAgICogQHBhcmFtIHtIVE1MQ2FudmFzRWxlbWVudH0gY2FudmFzXHJcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyBDdXN0b21pemF0aW9uIG9wdGlvbnNcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCwgb3B0aW9uczogYW55ID0ge30pIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuc2V0T3B0aW9ucyhvcHRpb25zKTtcclxuICAgICAgICB0aGlzLmhpc3RvcnlTaXplID0gdGhpcy5vcHRpb25zLmhpc3RvcnlTaXplO1xyXG4gICAgICAgIGlmIChvcHRpb25zLmhhc093blByb3BlcnR5KCdwb2ludHMnKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNldFBvaW50cyhvcHRpb25zLnBvaW50cyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5pdChjYW52YXMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlBVQkxJQyBBUEkqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG4gICAgLyoqXHJcbiAgICAgKiBDaGFuZ2UgY3VycmVudCBvcHR0aW9uc1xyXG4gICAgICogQHBhcmFtIG9wdGlvbnMgSlNPTiBvYmplY3RcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNldE9wdGlvbnMob3B0aW9uczogYW55KTogdm9pZCB7XHJcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLm9wdGlvbnMsIG9wdGlvbnMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVHJpZ2dlcnMgYSB2aWV3IHJlZnJlc2htZW50XHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcGFpbnQoY2FsbGJhY2s6IEZ1bmN0aW9uID0gKCkgPT4ge1xyXG4gICAgfSk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY2xlYXIoKTtcclxuICAgICAgICBpZiAodGhpcy5wYWludFNwbGluZU9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFpbnRTcGxpbmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FsbGJhY2sodGhpcy5jdHgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU3RhcnRzIGEgbmV3IGJsYW5rIHByb2plY3RcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyByZXNldChjYWxsYmFjazogRnVuY3Rpb24gPSAoKSA9PiB7XHJcbiAgICB9KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jbGVhcigpO1xyXG4gICAgICAgIHRoaXMuaGlzdG9yeVJlc2V0KCk7XHJcbiAgICAgICAgdGhpcy5jb25zdHJ1Y3Rpb25Qb2ludHMgPSBbXTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCBjdXJyZW50IHBvaW50cyAtIHVzZWQgZm9yIHN0YXRlIG1hbmFnZW1lbnQgKGltcG9ydC9leHBvcnQvaGlzdG9yeSkpXHJcbiAgICAgKiBAcmV0dXJucyB7QXJyYXk8YW55Pn1cclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldFBvaW50cygpOiBBcnJheTxhbnk+IHtcclxuICAgICAgICBjb25zdCByZXQgPSBbXTtcclxuICAgICAgICB0aGlzLmNvbnN0cnVjdGlvblBvaW50cy5mb3JFYWNoKChwb2ludDogQ29uc3RydWN0aW9uUG9pbnQpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc2V0ID0ge1xyXG4gICAgICAgICAgICAgICAgeDogcG9pbnQueCxcclxuICAgICAgICAgICAgICAgIHk6IHBvaW50LnksXHJcbiAgICAgICAgICAgICAgICBocDE6IHt4OiBwb2ludC5oYW5kbGVyMS54LCB5OiBwb2ludC5oYW5kbGVyMS55fVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAocG9pbnQuaGFuZGxlcjIpIHtcclxuICAgICAgICAgICAgICAgIHNldFsnaHAyJ10gPSB7eDogcG9pbnQuaGFuZGxlcjIueCwgeTogcG9pbnQuaGFuZGxlcjIueX07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0LnB1c2goc2V0KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2V0IGN1cnJlbnQgcG9pbnRzIC0gdXNlZCBmb3Igc3RhdGUgbWFuYWdlbWVudFxyXG4gICAgICogQHJldHVybnMge0FycmF5PGFueT59XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzZXRQb2ludHMocG9pbnRzOiBBcnJheTxhbnk+KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgICAgIHBvaW50cy5mb3JFYWNoKChwb2ludCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXJzZWQgPSBuZXcgQ29uc3RydWN0aW9uUG9pbnQocG9pbnQueCwgcG9pbnQueSk7XHJcbiAgICAgICAgICAgIHBhcnNlZC5oYW5kbGVyMSA9IG5ldyBQb2ludChwb2ludC5ocDEueCwgcG9pbnQuaHAxLnkpO1xyXG4gICAgICAgICAgICBpZiAocG9pbnQuaGFzT3duUHJvcGVydHkoJ2hwMicpKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJzZWQuaGFuZGxlcjIgPSBuZXcgUG9pbnQocG9pbnQuaHAyLngsIHBvaW50LmhwMi55KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmNvbnN0cnVjdGlvblBvaW50cy5wdXNoKHBhcnNlZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEaXNhYmxlIHJlbmRlcmluZ1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgaGlkZVNwbGluZSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnBhaW50U3BsaW5lT24gPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEVuYWJsZSByZW5kZXJpbmdcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNob3dTcGxpbmUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5wYWludFNwbGluZU9uID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENsZWFyIGNhbnZhc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY2xlYXIoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuY3R4KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3R4LmNsZWFyUmVjdCgtMSwgLTEsIDEgKyB0aGlzLmNhbnZhcy53aWR0aCwgMSArIHRoaXMuY2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2l2ZW4gYSBudW1iZXIgb2Ygc2hhcGVzIHRvIGRyYXc7IGdldCBhbGwgcG9zaXRpb25zIHdoZXJlIHRvIHBsYWNlIHNoYXBlcyB0byBiZSBzZXBhcmF0ZWQgYnkgYW4gZXF1YWwgZGlzdGFuY2VcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzaGFwZXNDb3VudCAgTnVtYmVyIG9mIHNoYXBlcyB0byBkcmF3IGFsb25nIHRoZSBzcGxpbmVcclxuICAgICAqIEByZXR1cm5zIHthbnl9ICBSZXR1cm4gYW4gYXJyYXkgd2l0aCBhbGwgcG9zaXRpb25zIG9uIHdoaWNoIGRyYXdpbmcgdGhlIHNoYXBlc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0UmVndWxhcmx5UGxhY2VkUG9pbnRzKHNoYXBlc0NvdW50OiBudW1iZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5jb25zdHJ1Y3Rpb25Qb2ludHMubGVuZ3RoIDwgMikge1xyXG4gICAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHBvaW50czogQXJyYXk8UG9pbnQ+ID0gW10sXHJcbiAgICAgICAgICAgIGJlemllcnM6IEFycmF5PEJlemllclV0aWxzPiA9IFtdO1xyXG5cclxuICAgICAgICAvLyBHZXR0aW5nIHRoZSB0b3RhbCBsZW5ndGhcclxuICAgICAgICBsZXQgbGVuZ3RoID0gMDtcclxuICAgICAgICB0aGlzLmNvbnN0cnVjdGlvblBvaW50cy5mb3JFYWNoKChjdXJyZW50UG9pbnQsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5leHRQb2ludCA9IHRoaXMuY29uc3RydWN0aW9uUG9pbnRzW2luZGV4ICsgMV07XHJcbiAgICAgICAgICAgIGlmIChudWxsID09IG5leHRQb2ludCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYnogPSBuZXcgQmV6aWVyVXRpbHMoXHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFBvaW50LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQb2ludC5oYW5kbGVyMiB8fCBjdXJyZW50UG9pbnQuaGFuZGxlcjEsXHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dFBvaW50LmhhbmRsZXIxLFxyXG4gICAgICAgICAgICAgICAgICAgIG5leHRQb2ludFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGJlemllcnMucHVzaChieik7XHJcbiAgICAgICAgICAgICAgICBsZW5ndGggKz0gYnouZ2V0TGVuZ3RoKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGRyYXduTnVtYmVyID0gMDtcclxuICAgICAgICBsZXQgY3VycmVudERpc3RhbmNlID0gMDtcclxuICAgICAgICBiZXppZXJzLmZvckVhY2goKGJ6LCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICBjdXJyZW50RGlzdGFuY2UgKz0gYnouZ2V0TGVuZ3RoKCk7XHJcbiAgICAgICAgICAgIGxldCBzaGFwZXNUb1N0aWNrID0gTWF0aC5mbG9vcigoY3VycmVudERpc3RhbmNlIC8gbGVuZ3RoKSAqIHNoYXBlc0NvdW50KSAtIGRyYXduTnVtYmVyO1xyXG4gICAgICAgICAgICBpZiAoaW5kZXggPT09IGJ6Lmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgICAgIHNoYXBlc1RvU3RpY2sgPSBzaGFwZXNDb3VudCAtIGRyYXduTnVtYmVyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGRyYXduTnVtYmVyICs9IHNoYXBlc1RvU3RpY2s7XHJcbiAgICAgICAgICAgIGlmIChzaGFwZXNUb1N0aWNrID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCBzaGFwZXNUb1N0aWNrOyB0ICs9IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgeCA9IE5hTiwgeSA9IE5hTjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IGJlemllcnMubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4ID0gYnoubXgodCAvIChzaGFwZXNUb1N0aWNrIC0gMSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5ID0gYnoubXkodCAvIChzaGFwZXNUb1N0aWNrIC0gMSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSBiei5teCh0IC8gKHNoYXBlc1RvU3RpY2spKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IGJ6Lm15KHQgLyAoc2hhcGVzVG9TdGljaykpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwb2ludHMucHVzaChuZXcgUG9pbnQoeCwgeSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBwb2ludHM7XHJcbiAgICB9XHJcbn1cclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vbm9kZV9tb2R1bGVzL3RzbGludC1sb2FkZXI/P3JlZi0tMSEuL3NyYy9CZXppZXJDYW52YXMudHMiLCJpZiAodHlwZW9mIE9iamVjdC5hc3NpZ24gIT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgLy8gTXVzdCBiZSB3cml0YWJsZTogdHJ1ZSwgZW51bWVyYWJsZTogZmFsc2UsIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE9iamVjdCwgXCJhc3NpZ25cIiwge1xyXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0LCB2YXJBcmdzKSB7IC8vIC5sZW5ndGggb2YgZnVuY3Rpb24gaXMgMlxyXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPT0gbnVsbCkgeyAvLyBUeXBlRXJyb3IgaWYgdW5kZWZpbmVkIG9yIG51bGxcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjb252ZXJ0IHVuZGVmaW5lZCBvciBudWxsIHRvIG9iamVjdCcpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgdG8gPSBPYmplY3QodGFyZ2V0KTtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMTsgaW5kZXggPCBhcmd1bWVudHMubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV4dFNvdXJjZSA9IGFyZ3VtZW50c1tpbmRleF07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG5leHRTb3VyY2UgIT0gbnVsbCkgeyAvLyBTa2lwIG92ZXIgaWYgdW5kZWZpbmVkIG9yIG51bGxcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuZXh0S2V5IGluIG5leHRTb3VyY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXZvaWQgYnVncyB3aGVuIGhhc093blByb3BlcnR5IGlzIHNoYWRvd2VkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobmV4dFNvdXJjZSwgbmV4dEtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvW25leHRLZXldID0gbmV4dFNvdXJjZVtuZXh0S2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdG87XHJcbiAgICAgICAgfSxcclxuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG59XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vbm9kZV9tb2R1bGVzL3RzbGludC1sb2FkZXI/P3JlZi0tMSEuL3NyYy9wb2x5ZmlsbHMudHMiLCJpbXBvcnQgUG9pbnQgZnJvbSAnLi9Qb2ludCc7XHJcblxyXG4vKipcclxuICogQmV6aWVyIGNvbnN0cnVjdGlvbiBwb2ludCByZXByZXNlbnRhdGlvblxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29uc3RydWN0aW9uUG9pbnQgZXh0ZW5kcyBQb2ludCB7XHJcbiAgICBwcml2YXRlIF9oYW5kbGVyMTogUG9pbnQgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBfaGFuZGxlcjI6IFBvaW50ID0gbnVsbDtcclxuICAgIHB1YmxpYyBmcm9tQ2FzdGVsamF1ID0gZmFsc2U7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGaXJzdCBjb250cm9sIHBvaW50IGdldHRlclxyXG4gICAgICogQHJldHVybnMge1BvaW50fVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0IGhhbmRsZXIxKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVyMTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIExhc3QgY29udHJvbCBwb2ludCBnZXR0ZXJcclxuICAgICAqIEByZXR1cm5zIHtQb2ludH1cclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldCBoYW5kbGVyMigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faGFuZGxlcjI7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGaXJzdCBjb250cm9sIHBvaW50IHNldHRlclxyXG4gICAgICogQHJldHVybnMge1BvaW50fVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc2V0IGhhbmRsZXIxKHBvaW50OiBQb2ludCkge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZXIxID0gcG9pbnQ7XHJcbiAgICAgICAgaWYgKHBvaW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZXIxLnBhcmVudCA9IHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTGFzdCBjb250cm9sIHBvaW50IHNldHRlclxyXG4gICAgICogQHJldHVybnMge1BvaW50fVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc2V0IGhhbmRsZXIyKHBvaW50OiBQb2ludCkge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZXIyID0gcG9pbnQ7XHJcbiAgICAgICAgaWYgKHBvaW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZXIyLnBhcmVudCA9IHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vbm9kZV9tb2R1bGVzL3RzbGludC1sb2FkZXI/P3JlZi0tMSEuL3NyYy9Db25zdHJ1Y3Rpb25Qb2ludC50cyIsIi8qKlxyXG4gKiBBdmFpbGFibGUgU2hhcGUgdHlwZXMgZm9yIGNvbnN0cnVjdGlvbiBwb2ludHMgcmVuZGVyaW5nXHJcbiAqIEB0eXBlIHt7U3F1YXJlOiBzdHJpbmc7IERpc2M6IHN0cmluZ319XHJcbiAqL1xyXG5leHBvcnQgY29uc3QgU2hhcGVzID0ge1xyXG4gICAgU3F1YXJlOiBcInNxdWFyZVwiLFxyXG4gICAgRGlzYzogICBcImRpc2NcIixcclxufTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9ub2RlX21vZHVsZXMvdHNsaW50LWxvYWRlcj8/cmVmLS0xIS4vc3JjL1NoYXBlcy50cyIsIi8qKlxyXG4gKiBBdmFpbGFibGUgdHlwZXMgb2YgbGluZSBjYXBzIGZvciBzcGxpbmUgcmVuZGVyaW5nXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMaW5lQ2FwIHtcclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIEJ1dHQgPSBcImJ1dHRcIjtcclxuICAgIHB1YmxpYyBzdGF0aWMgUm91bmQgPSBcInJvdW5kXCI7XHJcbiAgICBwdWJsaWMgc3RhdGljIFNxdWFyZSA9IFwic3F1YXJlXCI7XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBwYXJzZSh2YWw6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuICh2YWwgPT09IExpbmVDYXAuQnV0dCB8fCB2YWwgPT09IExpbmVDYXAuUm91bmQgfHwgdmFsID09PSBMaW5lQ2FwLlNxdWFyZSkgPyB2YWwgOiBMaW5lQ2FwLlJvdW5kO1xyXG4gICAgfVxyXG59O1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL25vZGVfbW9kdWxlcy90c2xpbnQtbG9hZGVyPz9yZWYtLTEhLi9zcmMvTGluZUNhcC50cyIsImltcG9ydCBQb2ludCBmcm9tICcuL1BvaW50JztcclxuXHJcbi8qKlxyXG4gKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gcGxhY2Ugc2hhcGVzIGFsb25nIHRoZSB3aG9sZSBzcGxpbmUgdG8gYW4gZXF1YWwgZGlzdGFuY2VcclxuICpcclxuICogKE5vdGUpOiBTb21lIHBhcnRzIG9mIHRoaXMgZmlsZSBoYXMgYmVlbiBsYXJnZWx5IGluc3BpcmVkIGJ5IHRoZSBmb2xsb3dpbmcgbGlua3MgOlxyXG4gKlxyXG4gKiAtIGh0dHBzOi8vZ2FtZWRldi5zdGFja2V4Y2hhbmdlLmNvbS9xdWVzdGlvbnMvNTM3My9cclxuICogL21vdmluZy1zaGlwcy1iZXR3ZWVuLXR3by1wbGFuZXRzLWFsb25nLWEtYmV6aWVyLW1pc3Npbmctc29tZS1lcXVhdGlvbnMtZm9yLWFjY2UvNTQyNyM1NDI3XHJcbiAqIC0gaHR0cDovL3d3dy5jYXJsb3NpY2F6YS5jb20vMjAxMi8wOC8xMlxyXG4gKiAvYW4tbW9yZS1lZmZpY2llbnQtd2F5LW9mLWNhbGN1bGF0aW5nLXRoZS1sZW5ndGgtb2YtYS1iZXppZXItY3VydmUtcGFydC1paS9cclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJlemllclV0aWxzIHtcclxuXHJcbiAgICAvLyBCZXppZXIgY29udHJvbCBwb2ludHMgb2YgdGhlIHNwbGluZSAoYSxiKSBhbmQgKGMsZClcclxuICAgIGE6IFBvaW50O1xyXG4gICAgYjogUG9pbnQ7XHJcbiAgICBjOiBQb2ludDtcclxuICAgIGQ6IFBvaW50O1xyXG4gICAgbGVuZ3RoOiBudW1iZXI7IC8vIHNwbGluZSBsZW5ndGhcclxuICAgIGxlbjogbnVtYmVyOyAvLyBwcmVjaXNpb24gc3RlcHNcclxuICAgIGFyY0xlbmd0aHM6IEFycmF5PG51bWJlcj47IC8vIFNwbGluZSBkaXZpc2lvbnNcclxuXHJcbiAgICAvKipcclxuICAgICAqIEN1YmljIGJlemllciBiYXNpYyBpbnRlcnBvbGF0aW9uIGFsZ29yaXRobSBmb3IgY3VydmUgQyAoUDAsIFAxLCBQMiwgUDMpIGF0IHBvc2l0aW9uIHRcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0XHJcbiAgICAgKiBAcGFyYW0ge1BvaW50fSBQMFxyXG4gICAgICogQHBhcmFtIHtQb2ludH0gUDFcclxuICAgICAqIEBwYXJhbSB7UG9pbnR9IFAyXHJcbiAgICAgKiBAcGFyYW0ge1BvaW50fSBQM1xyXG4gICAgICogQHJldHVybnMge1BvaW50fVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3ViaWNCZXppZXJJbnRlcnBvbGF0ZSA9ICh0OiBudW1iZXIsIFAwOiBQb2ludCwgUDE6IFBvaW50LCBQMjogUG9pbnQsIFAzOiBQb2ludCk6IFBvaW50ID0+IHtcclxuICAgICAgICBjb25zdCB4ID0gUDAueCAqIE1hdGgucG93KDEgLSB0LCAzKSArIDMgKiBQMS54ICogdCAqIE1hdGgucG93KCgxIC0gdCksIDIpXHJcbiAgICAgICAgICAgICsgMyAqIFAyLnggKiB0ICogdCAqICgxIC0gdCkgKyArUDMueCAqIHQgKiB0ICogdDtcclxuICAgICAgICBjb25zdCB5ID0gUDAueSAqIE1hdGgucG93KDEgLSB0LCAzKSArIDMgKiBQMS55ICogdCAqIE1hdGgucG93KCgxIC0gdCksIDIpXHJcbiAgICAgICAgICAgICsgMyAqIFAyLnkgKiB0ICogdCAqICgxIC0gdCkgKyArUDMueSAqIHQgKiB0ICogdDtcclxuICAgICAgICByZXR1cm4gbmV3IFBvaW50KHgsIHkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3ViaWMgYmV6aWVyIGJhc2ljIGludGVycG9sYXRpb24gYWxnb3JpdGhtIHNob3J0Y3V0XHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdFxyXG4gICAgICogQHJldHVybnMge1BvaW50fVxyXG4gICAgICovXHJcbiAgICBpbnRlcnBvbGF0ZSA9ICh0OiBudW1iZXIpOiBQb2ludCA9PiB7XHJcbiAgICAgICAgcmV0dXJuIEJlemllclV0aWxzLmN1YmljQmV6aWVySW50ZXJwb2xhdGUodCwgdGhpcy5hLCB0aGlzLmIsIHRoaXMuYywgdGhpcy5kKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhOiBQb2ludCwgYjogUG9pbnQsIGM6IFBvaW50LCBkOiBQb2ludCwgbGVuOiBudW1iZXIgPSAyMDApIHtcclxuICAgICAgICB0aGlzLmEgPSBhO1xyXG4gICAgICAgIHRoaXMuYiA9IGI7XHJcbiAgICAgICAgdGhpcy5jID0gYztcclxuICAgICAgICB0aGlzLmQgPSBkO1xyXG5cclxuICAgICAgICB0aGlzLmxlbiA9IGxlbjtcclxuICAgICAgICB0aGlzLmFyY0xlbmd0aHMgPSBuZXcgQXJyYXkodGhpcy5sZW4gKyAxKTtcclxuICAgICAgICB0aGlzLmFyY0xlbmd0aHNbMF0gPSAwO1xyXG5cclxuICAgICAgICBjb25zdCBpbnRlcnBvbGF0aW9uUG9pbnQgPSB0aGlzLmludGVycG9sYXRlKDApO1xyXG4gICAgICAgIGxldCBveCA9IGludGVycG9sYXRpb25Qb2ludC54LCBveSA9IGludGVycG9sYXRpb25Qb2ludC55O1xyXG4gICAgICAgIGxldCBjbGVuID0gMDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSB0aGlzLmxlbjsgaSArPSAxKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGludGVycG9sYXRpb24gPSB0aGlzLmludGVycG9sYXRlKGkgLyBsZW4pO1xyXG4gICAgICAgICAgICBjb25zdCB4ID0gaW50ZXJwb2xhdGlvbi54O1xyXG4gICAgICAgICAgICBjb25zdCB5ID0gaW50ZXJwb2xhdGlvbi55O1xyXG4gICAgICAgICAgICBjb25zdCBkeCA9IG94IC0geCwgZHkgPSBveSAtIHk7XHJcbiAgICAgICAgICAgIGNsZW4gKz0gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTtcclxuICAgICAgICAgICAgdGhpcy5hcmNMZW5ndGhzW2ldID0gY2xlbjtcclxuICAgICAgICAgICAgb3ggPSB4O1xyXG4gICAgICAgICAgICBveSA9IHk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUG9pbnQgcmUtbWFwcGVyLCB0cnkgdG8gcmVtYXAgYSBjb29yZGluYXRlIGJ5IGlnbm9yaW5nIHNwbGluZSBkeW5hbWlzbSxcclxuICAgICAqIGllOiAwLjUgc2hvdWxkIHJlZmVyIHRvIHRoZSBtaWRkbGUgb2YgdGhlIHNwbGluZVxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHUgYmV6aWVyIGNvb3JkaW5hdGVcclxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IG1hcHBlZFxyXG4gICAgICovXHJcbiAgICBtYXAodTogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0TGVuZ3RoID0gdSAqIHRoaXMuYXJjTGVuZ3Roc1t0aGlzLmxlbl07XHJcbiAgICAgICAgbGV0IGxvdyA9IDAsIGhpZ2ggPSB0aGlzLmxlbiwgaW5kZXggPSAwO1xyXG4gICAgICAgIHdoaWxlIChsb3cgPCBoaWdoKSB7XHJcbiAgICAgICAgICAgIGluZGV4ID0gbG93ICsgKCgoaGlnaCAtIGxvdykgLyAyKSB8IDApO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hcmNMZW5ndGhzW2luZGV4XSA8IHRhcmdldExlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgbG93ID0gaW5kZXggKyAxO1xyXG5cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGhpZ2ggPSBpbmRleDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5hcmNMZW5ndGhzW2luZGV4XSA+IHRhcmdldExlbmd0aCkge1xyXG4gICAgICAgICAgICBpbmRleC0tO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgbGVuZ3RoQmVmb3JlID0gdGhpcy5hcmNMZW5ndGhzW2luZGV4XTtcclxuICAgICAgICBpZiAobGVuZ3RoQmVmb3JlID09PSB0YXJnZXRMZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGluZGV4IC8gdGhpcy5sZW47XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoaW5kZXggKyAodGFyZ2V0TGVuZ3RoIC0gbGVuZ3RoQmVmb3JlKSAvICh0aGlzLmFyY0xlbmd0aHNbaW5kZXggKyAxXSAtIGxlbmd0aEJlZm9yZSkpIC8gdGhpcy5sZW47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBhIGJlemllciBwb2ludCB0byBhIGNhcnRlc2lhbiBvbmUgKHgpXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdSBiZXppZXIgcG9pbnQgKDAgdG8gMSlcclxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IHBvaW50LnhcclxuICAgICAqL1xyXG4gICAgbXgodTogbnVtYmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJwb2xhdGUodGhpcy5tYXAodSkpLng7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNYXBzIGEgYmV6aWVyIHBvaW50IHRvIGEgY2FydGVzaWFuIG9uZSAoeSlcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB1IGJlemllciBwb2ludCAoMCB0byAxKVxyXG4gICAgICogQHJldHVybnMge251bWJlcn0gcG9pbnQueVxyXG4gICAgICovXHJcbiAgICBteSh1OiBudW1iZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnRlcnBvbGF0ZSh0aGlzLm1hcCh1KSkueTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHRoZSBzcGxpbmUgbGVuZ3RoXHJcbiAgICAgKiBzb3VyY2U6IGh0dHA6Ly93d3cuY2FybG9zaWNhemEuY29tLzIwMTIvMDgvMTJcclxuICAgICAqIC9hbi1tb3JlLWVmZmljaWVudC13YXktb2YtY2FsY3VsYXRpbmctdGhlLWxlbmd0aC1vZi1hLWJlemllci1jdXJ2ZS1wYXJ0LWlpL1xyXG4gICAgICovXHJcbiAgICBnZXRMZW5ndGgoKSB7XHJcbiAgICAgICAgY29uc3Qgc3RlcHMgPSAxMDA7XHJcbiAgICAgICAgY29uc3QgaW5jID0gMTAwO1xyXG4gICAgICAgIGxldCBsZW5ndGggPSAwO1xyXG4gICAgICAgIGxldCB0ID0gMDtcclxuICAgICAgICBjb25zdCBwdCA9IHt4OiBOYU4sIHk6IE5hTn07XHJcbiAgICAgICAgY29uc3QgcHJldlB0ID0ge3g6IE5hTiwgeTogTmFOfTtcclxuICAgICAgICBjb25zdCBjOiBBcnJheTxQb2ludD4gPSBbdGhpcy5hLCB0aGlzLmIsIHRoaXMuYywgdGhpcy5kXTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGluYzsgaSArPSAxKSB7XHJcbiAgICAgICAgICAgIHQgPSBpIC8gc3RlcHM7XHJcbiAgICAgICAgICAgIGNvbnN0IHQxOiBudW1iZXIgPSAxLjAgLSB0O1xyXG4gICAgICAgICAgICBjb25zdCB0MV8zOiBudW1iZXIgPSB0MSAqIHQxICogdDE7XHJcbiAgICAgICAgICAgIGNvbnN0IHQxXzNhOiBudW1iZXIgPSAoMyAqIHQpICogKHQxICogdDEpO1xyXG4gICAgICAgICAgICBjb25zdCB0MV8zYjogbnVtYmVyID0gKDMgKiAodCAqIHQpKSAqIHQxO1xyXG4gICAgICAgICAgICBjb25zdCB0MV8zYzogbnVtYmVyID0gKHQgKiB0ICogdCApO1xyXG4gICAgICAgICAgICBwdC54ID0gKGNbMF0ueCAqIHQxXzMpICsgKHQxXzNhICogY1sxXS54KSArICh0MV8zYiAqIGNbMl0ueCkgKyAodDFfM2MgKiBjWzNdLngpO1xyXG4gICAgICAgICAgICBwdC55ID0gKGNbMF0ueSAqIHQxXzMpICsgKHQxXzNhICogY1sxXS55KSArICh0MV8zYiAqIGNbMl0ueSkgKyAodDFfM2MgKiBjWzNdLnkpO1xyXG4gICAgICAgICAgICBpZiAoaSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHggPSBwdC54IC0gcHJldlB0Lng7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB5ID0gcHQueSAtIHByZXZQdC55O1xyXG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gbGVuZ3RoICsgTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHByZXZQdC54ID0gcHQueDtcclxuICAgICAgICAgICAgcHJldlB0LnkgPSBwdC55O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbGVuZ3RoO1xyXG4gICAgfVxyXG59XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL25vZGVfbW9kdWxlcy90c2xpbnQtbG9hZGVyPz9yZWYtLTEhLi9zcmMvQmV6aWVyVXRpbHMudHMiLCJpbXBvcnQge0tleXN9IGZyb20gJy4vS2V5cyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBIaXN0b3J5TWFuYWdlckFic3RyYWN0IHtcclxuXHJcbiAgICBwcml2YXRlIHN0YXRlc0N1cnNvciA9IDA7XHJcbiAgICBwcml2YXRlIHN0YXRlc1N0YWNrID0gW107XHJcbiAgICBwcm90ZWN0ZWQgbGFzdEhpc3RvcnlTdGF0ZUhhc2ggPSBudWxsO1xyXG5cclxuICAgIHByaXZhdGUgc2FmZVN0YXRlc0N1cnNvcihjdXJzb3I6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuc3RhdGVzQ3Vyc29yID0gTWF0aC5tYXgoMCwgTWF0aC5taW4odGhpcy5zdGF0ZXNTdGFjay5sZW5ndGggLSAxLCBjdXJzb3IpKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZXNDdXJzb3I7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZW1vdmVGaXJzdFN0YXRlKCkge1xyXG4gICAgICAgIHRoaXMuc3RhdGVzU3RhY2suc2hpZnQoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHN0YXRlc0JhY2t3YXJkKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXRlc1N0YWNrLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmFwcGx5SGlzdG9yeVN0YXRlKHRoaXMuc3RhdGVzU3RhY2tbdGhpcy5zYWZlU3RhdGVzQ3Vyc29yKHRoaXMuc3RhdGVzQ3Vyc29yIC0gMSldKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzdGF0ZXNGb3J3YXJkKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXRlc1N0YWNrLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmFwcGx5SGlzdG9yeVN0YXRlKHRoaXMuc3RhdGVzU3RhY2tbdGhpcy5zYWZlU3RhdGVzQ3Vyc29yKHRoaXMuc3RhdGVzQ3Vyc29yICsgMSldKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIGhpc3RvcnlNYW5hZ2VySGFuZGxlS2V5Ym9hcmRFdmVudHMoZTogS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgICAgIGNvbnN0IGNvZGUgPSBlLndoaWNoIHx8IGUua2V5Q29kZTtcclxuICAgICAgICBpZiAoY29kZSA9PT0gS2V5cy5aICYmIGUuY3RybEtleSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0YXRlc0JhY2t3YXJkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjb2RlID09PSBLZXlzLlkgJiYgZS5jdHJsS2V5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGVzRm9yd2FyZCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgcHVzaEhpc3RvcnlTdGF0ZShzdGF0ZTogYW55ID0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMuc3RhdGVzU3RhY2sgPSB0aGlzLnN0YXRlc1N0YWNrLnNsaWNlKDAsIHRoaXMuc3RhdGVzQ3Vyc29yICsgMSk7XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdGVzU3RhY2subGVuZ3RoID09PSB0aGlzLmhpc3RvcnlTaXplKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlRmlyc3RTdGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnN0YXRlc1N0YWNrLnB1c2goc3RhdGUgfHwgdGhpcy5nZXRDdXJyZW50U3RhdGUoKSk7XHJcbiAgICAgICAgdGhpcy5zdGF0ZXNDdXJzb3IgPSB0aGlzLnN0YXRlc1N0YWNrLmxlbmd0aCAtIDE7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIHB1c2hIaXN0b3J5U3RhdGVJZkNoYW5nZWQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZ2V0Q3VycmVudFN0YXRlSGFzaCgpICE9PSB0aGlzLmxhc3RIaXN0b3J5U3RhdGVIYXNoKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdEhpc3RvcnlTdGF0ZUhhc2ggPSB0aGlzLmdldEN1cnJlbnRTdGF0ZUhhc2goKTtcclxuICAgICAgICAgICAgdGhpcy5wdXNoSGlzdG9yeVN0YXRlKHRoaXMuZ2V0Q3VycmVudFN0YXRlKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaGlzdG9yeVJlc2V0KCkge1xyXG4gICAgICAgIHRoaXMuc3RhdGVzQ3Vyc29yID0gMDtcclxuICAgICAgICB0aGlzLnN0YXRlc1N0YWNrID0gW107XHJcbiAgICAgICAgdGhpcy5sYXN0SGlzdG9yeVN0YXRlSGFzaCA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIGFic3RyYWN0IGdldEN1cnJlbnRTdGF0ZSgpO1xyXG5cclxuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBnZXRDdXJyZW50U3RhdGVIYXNoKCk7XHJcblxyXG4gICAgcHJvdGVjdGVkIGFic3RyYWN0IGFwcGx5SGlzdG9yeVN0YXRlKGhpc3RvcnlTdGF0ZTogYW55KTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgaGlzdG9yeVNpemUgPSA1MCkge1xyXG4gICAgfVxyXG59XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vbm9kZV9tb2R1bGVzL3RzbGludC1sb2FkZXI/P3JlZi0tMSEuL3NyYy9IaXN0b3J5TWFuYWdlckFic3RyYWN0LnRzIiwiLyoqXHJcbiAqIEtleWJvYXJkIGtleSBjb2Rlc1xyXG4gKiBAdHlwZSB7e0NUUkw6IG51bWJlcjsgWTogbnVtYmVyOyBaOiBudW1iZXJ9fVxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IEtleXMgPSB7XHJcbiAgICBDVFJMOiAxNyxcclxuICAgIFk6IDg5LFxyXG4gICAgWjogOTBcclxufTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9ub2RlX21vZHVsZXMvdHNsaW50LWxvYWRlcj8/cmVmLS0xIS4vc3JjL0tleXMudHMiXSwic291cmNlUm9vdCI6IiJ9